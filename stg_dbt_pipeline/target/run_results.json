{"metadata": {"dbt_schema_version": "https://schemas.getdbt.com/dbt/run-results/v5.json", "dbt_version": "1.7.11", "generated_at": "2024-04-14T18:20:13.168783Z", "invocation_id": "827b4a33-02c7-439d-9d8b-a75ec61f995a", "env": {}}, "results": [{"status": "success", "timing": [{"name": "compile", "started_at": "2024-04-14T18:19:14.564108Z", "completed_at": "2024-04-14T18:19:14.568865Z"}, {"name": "execute", "started_at": "2024-04-14T18:19:14.657685Z", "completed_at": "2024-04-14T18:19:29.251755Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 14.705225944519043, "adapter_response": {"_message": "OK", "query_id": "01eefa8b-810b-1f84-8167-f98c1fe68dd9"}, "message": "OK", "failures": null, "unique_id": "model.stridetechgo.enriched_facility", "compiled": true, "compiled_code": "SELECT \n    facility,\n    md5(facility) AS facility_id,\n    current_timestamp() AS lastupdated\nFROM `dev`.`integrated`.`physical_therapy_evals`\nGROUP BY \n    facility,\n    md5(facility)", "relation_name": "`dev`.`dbt-nstankus_enriched`.`enriched_facility`"}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2024-04-14T18:19:29.265002Z", "completed_at": "2024-04-14T18:19:29.289875Z"}, {"name": "execute", "started_at": "2024-04-14T18:19:29.292384Z", "completed_at": "2024-04-14T18:19:30.495997Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 1.2398769855499268, "adapter_response": {"_message": "OK", "query_id": "01eefa8b-88ee-1157-975d-abc1752b7bba"}, "message": null, "failures": 0, "unique_id": "test.stridetechgo.not_null_enriched_facility_facility_id.5683237b68", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect facility_id\nfrom `dev`.`dbt-nstankus_enriched`.`enriched_facility`\nwhere facility_id is null\n\n\n", "relation_name": null}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2024-04-14T18:19:29.282416Z", "completed_at": "2024-04-14T18:19:29.290551Z"}, {"name": "execute", "started_at": "2024-04-14T18:19:29.310173Z", "completed_at": "2024-04-14T18:19:30.740069Z"}], "thread_id": "Thread-5 (worker)", "execution_time": 1.4844470024108887, "adapter_response": {"_message": "OK", "query_id": "01eefa8b-88de-11e3-a0c4-0d88966dc7e8"}, "message": null, "failures": 0, "unique_id": "test.stridetechgo.unique_enriched_facility_facility_id.a65163b9e3", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    facility_id as unique_field,\n    count(*) as n_records\n\nfrom `dev`.`dbt-nstankus_enriched`.`enriched_facility`\nwhere facility_id is not null\ngroup by facility_id\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-04-14T18:19:14.554632Z", "completed_at": "2024-04-14T18:19:14.567893Z"}, {"name": "execute", "started_at": "2024-04-14T18:19:14.569443Z", "completed_at": "2024-04-14T18:19:43.265733Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 28.720176935195923, "adapter_response": {"_message": "OK", "query_id": "01eefa8b-810b-1877-a687-bff680514feb"}, "message": "OK", "failures": null, "unique_id": "model.stridetechgo.curated_fact_stg", "compiled": true, "compiled_code": "SELECT \n    -- Timestamp extrapolation\n    CAST(from_unixtime( -- Convert from unixtime back to UTC\n        (unix_timestamp(device_time) -- Convert timestamp to sec from ms\n        - MIN(unix_timestamp(device_time)) OVER (PARTITION BY user, week)) -- Subtract by min timestamp over user/week\n        + start_time)  -- Add start time for user/week \n    AS timestamp) AS user_time, \n    CAST(unix_timestamp(device_time) -- Convert timestamp to sec from ms\n        - MIN(unix_timestamp(device_time)) OVER (PARTITION BY user, week) -- Subtract by min timestamp over user/week\n    AS timestamp) AS session_time,\n    -- Metrics definition\n    CASE \n        WHEN left_lbf > force_threshold AND activity_flag = 1 THEN 1\n            WHEN left_lbf IS NOT NULL THEN 0\n            ELSE NULL\n    END AS left_misuse_flag,\n    CASE \n        WHEN right_lbf > force_threshold AND activity_flag = 1 THEN 1\n            WHEN right_lbf IS NOT NULL THEN 0\n            ELSE NULL\n    END AS right_misuse_flag,\n    CASE \n        WHEN hip_distance > hip_distance_threshold AND activity_flag = 1 THEN 1\n            WHEN hip_distance IS NOT NULL THEN 0\n            ELSE NULL\n    END AS hip_misuse_flag,\n    CASE \n        WHEN (left_lbf > force_threshold OR right_lbf > force_threshold OR hip_distance > hip_distance_threshold) AND activity_flag = 1 THEN 1\n            WHEN COALESCE(left_lbf, right_lbf, hip_distance) IS NOT NULL THEN 0\n            ELSE NULL\n    END AS total_misuse_flag,\n    activity_flag,\n    -- Imposing range constraints on lbf\n    CASE \n        WHEN left_lbf < 0 THEN 0\n        WHEN left_lbf > 100 THEN 100\n        ELSE left_lbf\n    END AS left_lbf,\n    CASE \n        WHEN right_lbf < 0 THEN 0\n        WHEN right_lbf > 100 THEN 100\n        ELSE right_lbf\n    END AS right_lbf,\n    left_adc,\n    right_adc,\n    hip_distance,\n    left_vibration_trigger,\n    right_vibration_trigger,\n    hip_vibration_trigger,\n    force_threshold,\n    hip_distance_threshold,\n    baseline_left_adc,\n    baseline_right_adc,\n    left_adc_change,\n    right_adc_change,\n    accelerometer_motion_flag,\n    file_path,\n    device,\n    week,\n    file,\n    user,\n    fsr_length_adjustment,\n    trial_type,\n    run_id,\n    extraction_time as extraction_time\nFROM `dev`.`integrated`.`stg_nodes` base", "relation_name": "`dev`.`dbt-nstankus_curated`.`curated_fact_stg`"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-04-14T18:19:43.294300Z", "completed_at": "2024-04-14T18:19:43.300331Z"}, {"name": "execute", "started_at": "2024-04-14T18:19:43.313800Z", "completed_at": "2024-04-14T18:19:50.417196Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 7.143229961395264, "adapter_response": {"_message": "OK", "query_id": "01eefa8b-9146-1aed-ad8c-7b7fba23599f"}, "message": "OK", "failures": null, "unique_id": "model.stridetechgo.enriched_user", "compiled": true, "compiled_code": "SELECT DISTINCT \n    COALESCE(f.user, pt.user, s.user) AS user,\n    s.age,\n    s.gender,\n    s.height_in,\n    s.weight_lbs,\n    s.dob,\n    s.walker_trainer,\n    s.walker_purchased_from,\n    s.walker_manufacturer,\n    md5(COALESCE(f.user, pt.user, s.user)) AS user_id,\n    CAST(\n        RIGHT(\n            COALESCE(f.user, pt.user, s.user),\n            LENGTH(COALESCE(f.user, pt.user, s.user)) - 1\n        ) AS INTEGER)\n     AS user_no,\n    current_timestamp() AS lastupdated\nFROM `dev`.`dbt-nstankus_curated`.`curated_fact_stg` f\nLEFT JOIN `dev`.`integrated`.`physical_therapy_evals` pt\n    ON pt.user = f.user\nLEFT JOIN `dev`.`integrated`.`user_surveys` s\n    ON s.user = f.user\nWHERE COALESCE(f.user, pt.user, s.user) IS NOT NULL", "relation_name": "`dev`.`dbt-nstankus_enriched`.`enriched_user`"}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2024-04-14T18:19:50.429270Z", "completed_at": "2024-04-14T18:19:50.439141Z"}, {"name": "execute", "started_at": "2024-04-14T18:19:50.441908Z", "completed_at": "2024-04-14T18:19:50.996424Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.5751898288726807, "adapter_response": {"_message": "OK", "query_id": "01eefa8b-9537-1e61-a023-57c840ebbd01"}, "message": null, "failures": 0, "unique_id": "test.stridetechgo.not_null_enriched_user_user_id.fc955e4659", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect user_id\nfrom `dev`.`dbt-nstankus_enriched`.`enriched_user`\nwhere user_id is null\n\n\n", "relation_name": null}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2024-04-14T18:19:50.433539Z", "completed_at": "2024-04-14T18:19:50.439645Z"}, {"name": "execute", "started_at": "2024-04-14T18:19:50.445314Z", "completed_at": "2024-04-14T18:19:51.212334Z"}], "thread_id": "Thread-5 (worker)", "execution_time": 0.7903318405151367, "adapter_response": {"_message": "OK", "query_id": "01eefa8b-9536-120d-bd07-10b8cc69fa53"}, "message": null, "failures": 0, "unique_id": "test.stridetechgo.unique_enriched_user_user_id.7903fc603b", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    user_id as unique_field,\n    count(*) as n_records\n\nfrom `dev`.`dbt-nstankus_enriched`.`enriched_user`\nwhere user_id is not null\ngroup by user_id\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-04-14T18:19:43.291532Z", "completed_at": "2024-04-14T18:19:43.299517Z"}, {"name": "execute", "started_at": "2024-04-14T18:19:43.310828Z", "completed_at": "2024-04-14T18:19:51.465621Z"}], "thread_id": "Thread-6 (worker)", "execution_time": 8.192361831665039, "adapter_response": {"_message": "OK", "query_id": "01eefa8b-9223-1cb3-8464-6cb2f02e712f"}, "message": "OK", "failures": null, "unique_id": "model.stridetechgo.enriched_trial", "compiled": true, "compiled_code": "SELECT \n    trial_type,\n    MD5(trial_type) AS trial_id,\n    current_timestamp() AS lastupdated\nFROM `dev`.`dbt-nstankus_curated`.`curated_fact_stg`\nGROUP BY \n    trial_type,\n    MD5(trial_type)", "relation_name": "`dev`.`dbt-nstankus_enriched`.`enriched_trial`"}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2024-04-14T18:19:51.481556Z", "completed_at": "2024-04-14T18:19:51.492820Z"}, {"name": "execute", "started_at": "2024-04-14T18:19:51.494895Z", "completed_at": "2024-04-14T18:19:51.957250Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.4867231845855713, "adapter_response": {"_message": "OK", "query_id": "01eefa8b-95d7-1cf2-9c9f-35d983c0965f"}, "message": null, "failures": 0, "unique_id": "test.stridetechgo.not_null_enriched_trial_trial_id.8ef1d288ad", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect trial_id\nfrom `dev`.`dbt-nstankus_enriched`.`enriched_trial`\nwhere trial_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-04-14T18:19:43.288976Z", "completed_at": "2024-04-14T18:19:43.298452Z"}, {"name": "execute", "started_at": "2024-04-14T18:19:43.305203Z", "completed_at": "2024-04-14T18:19:52.164264Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 8.89126706123352, "adapter_response": {"_message": "OK", "query_id": "01eefa8b-9141-1516-ad9f-d59f74564dbe"}, "message": "OK", "failures": null, "unique_id": "model.stridetechgo.enriched_hour", "compiled": true, "compiled_code": "SELECT \n    week,\n    cast(substring(week, len(week)-1, len(week)) AS int) AS week_num,\n    date_trunc('day', user_time) AS day,\n    date_trunc('hour', user_time) AS hour,\n    md5(date_trunc('hour', user_time) || week) AS hour_id,\n    current_timestamp() AS lastupdated\nFROM `dev`.`dbt-nstankus_curated`.`curated_fact_stg`\nGROUP BY \n    week,\n    date_trunc('day', user_time),\n    date_trunc('hour', user_time),\n    md5(date_trunc('hour', user_time) || week)", "relation_name": "`dev`.`dbt-nstankus_enriched`.`enriched_hour`"}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2024-04-14T18:19:51.487650Z", "completed_at": "2024-04-14T18:19:51.493383Z"}, {"name": "execute", "started_at": "2024-04-14T18:19:51.498034Z", "completed_at": "2024-04-14T18:19:52.220483Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.7480361461639404, "adapter_response": {"_message": "OK", "query_id": "01eefa8b-95d9-1282-807b-3cc7b9063a9b"}, "message": null, "failures": 0, "unique_id": "test.stridetechgo.unique_enriched_trial_trial_id.42bec42e1a", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    trial_id as unique_field,\n    count(*) as n_records\n\nfrom `dev`.`dbt-nstankus_enriched`.`enriched_trial`\nwhere trial_id is not null\ngroup by trial_id\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2024-04-14T18:19:52.177398Z", "completed_at": "2024-04-14T18:19:52.185882Z"}, {"name": "execute", "started_at": "2024-04-14T18:19:52.187737Z", "completed_at": "2024-04-14T18:19:52.717570Z"}], "thread_id": "Thread-6 (worker)", "execution_time": 0.5494120121002197, "adapter_response": {"_message": "OK", "query_id": "01eefa8b-9645-1800-a0da-8d0635ad9b60"}, "message": null, "failures": 0, "unique_id": "test.stridetechgo.not_null_enriched_hour_hour_id.9212fc7e6e", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect hour_id\nfrom `dev`.`dbt-nstankus_enriched`.`enriched_hour`\nwhere hour_id is null\n\n\n", "relation_name": null}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2024-04-14T18:19:52.181841Z", "completed_at": "2024-04-14T18:19:52.186382Z"}, {"name": "execute", "started_at": "2024-04-14T18:19:52.191395Z", "completed_at": "2024-04-14T18:19:52.919702Z"}], "thread_id": "Thread-5 (worker)", "execution_time": 0.7510998249053955, "adapter_response": {"_message": "OK", "query_id": "01eefa8b-9642-1665-8ab5-d6fe850ad5a2"}, "message": null, "failures": 0, "unique_id": "test.stridetechgo.unique_enriched_hour_hour_id.b2e40e661f", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    hour_id as unique_field,\n    count(*) as n_records\n\nfrom `dev`.`dbt-nstankus_enriched`.`enriched_hour`\nwhere hour_id is not null\ngroup by hour_id\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-04-14T18:19:43.284909Z", "completed_at": "2024-04-14T18:19:43.297625Z"}, {"name": "execute", "started_at": "2024-04-14T18:19:43.300825Z", "completed_at": "2024-04-14T18:19:54.123232Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 10.867462158203125, "adapter_response": {"_message": "OK", "query_id": "01eefa8b-91e3-109a-a79b-74b833ff5cd3"}, "message": "OK", "failures": null, "unique_id": "model.stridetechgo.enriched_device", "compiled": true, "compiled_code": "SELECT \n    COALESCE(f.device, pt.device, s.device) AS device,\n    md5(COALESCE(f.device, pt.device, s.device)) AS device_id,\n    current_timestamp() AS lastupdated\nFROM `dev`.`dbt-nstankus_curated`.`curated_fact_stg` f\nFULL JOIN `dev`.`integrated`.`physical_therapy_evals` pt\n    ON pt.device = f.device\nFULL JOIN `dev`.`integrated`.`user_surveys` s\n    ON s.device = f.device\nWHERE COALESCE(f.device, pt.device, s.device) IS NOT NULL\nGROUP BY \n    COALESCE(f.device, pt.device, s.device),\n    md5(COALESCE(f.device, pt.device, s.device))", "relation_name": "`dev`.`dbt-nstankus_enriched`.`enriched_device`"}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2024-04-14T18:19:54.152782Z", "completed_at": "2024-04-14T18:19:54.161661Z"}, {"name": "execute", "started_at": "2024-04-14T18:19:54.163625Z", "completed_at": "2024-04-14T18:19:54.630575Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.48788976669311523, "adapter_response": {"_message": "OK", "query_id": "01eefa8b-976f-1ef6-b823-aa7093b3abed"}, "message": null, "failures": 0, "unique_id": "test.stridetechgo.not_null_enriched_device_device_id.3e9e77ed3d", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect device_id\nfrom `dev`.`dbt-nstankus_enriched`.`enriched_device`\nwhere device_id is null\n\n\n", "relation_name": null}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2024-04-14T18:19:54.157366Z", "completed_at": "2024-04-14T18:19:54.162159Z"}, {"name": "execute", "started_at": "2024-04-14T18:19:54.166271Z", "completed_at": "2024-04-14T18:19:54.780235Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.6365687847137451, "adapter_response": {"_message": "OK", "query_id": "01eefa8b-9771-16a2-b532-55881a445b78"}, "message": null, "failures": 0, "unique_id": "test.stridetechgo.unique_enriched_device_device_id.923130e507", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    device_id as unique_field,\n    count(*) as n_records\n\nfrom `dev`.`dbt-nstankus_enriched`.`enriched_device`\nwhere device_id is not null\ngroup by device_id\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-04-14T18:19:54.795732Z", "completed_at": "2024-04-14T18:19:54.805494Z"}, {"name": "execute", "started_at": "2024-04-14T18:19:54.807420Z", "completed_at": "2024-04-14T18:19:58.957032Z"}], "thread_id": "Thread-6 (worker)", "execution_time": 4.171266078948975, "adapter_response": {"_message": "OK", "query_id": "01eefa8b-981e-112c-b6b6-b8c7888b3a8f"}, "message": "OK", "failures": null, "unique_id": "model.stridetechgo.curated_fact_physical_therapy_evals", "compiled": true, "compiled_code": "SELECT \n    NULL AS start_week,\n    NULL AS end_week,\n    start_abc_score,\n    start_tug_score_fastest_attempt,\n    start_tandem_balance_total_time,\n    start_successful_tandem_balance_positions,\n    start_functional_reach,\n    end_abc_score,\n    end_tug_score_fastest_attempt,\n    end_tandem_balance_score_total,\n    end_successful_tandem_balance_positions,\n    end_functional_reach,\n    d.device_id,\n    u.user_id,\n    fac.facility_id,\n    current_timestamp() AS lastupdated\nfrom `dev`.`integrated`.`physical_therapy_evals` pt\nleft join `dev`.`dbt-nstankus_enriched`.`enriched_device` d\n    on d.device = pt.device\nleft join `dev`.`dbt-nstankus_enriched`.`enriched_user` u\n    on u.user = pt.user\nleft join `dev`.`dbt-nstankus_enriched`.`enriched_facility` fac\n    on fac.facility = pt.facility", "relation_name": "`dev`.`dbt-nstankus_curated`.`curated_fact_physical_therapy_evals`"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-04-14T18:19:54.800588Z", "completed_at": "2024-04-14T18:19:54.806022Z"}, {"name": "execute", "started_at": "2024-04-14T18:19:54.811098Z", "completed_at": "2024-04-14T18:20:01.728591Z"}], "thread_id": "Thread-5 (worker)", "execution_time": 6.94163703918457, "adapter_response": {"_message": "OK", "query_id": "01eefa8b-981f-13b7-b520-6687a16fd382"}, "message": "OK", "failures": null, "unique_id": "model.stridetechgo.curated_fact_user_surveys", "compiled": true, "compiled_code": "SELECT \n    self_reported_physical_activity_per_week_hrs,\n    satisfied_with_activity,\n    fear_of_falling,\n    fall_history,\n    length_of_time_using_walker,\n    likes_using_walker,\n    received_walker_training,\n    description_of_changes_in_DLa,\n    would_purchase_stg,\n    how_much_would_you_pay,\n    would_recommend_stg,\n    stg_helped_learn_use_walker_better,\n    d.device_id,\n    u.user_id,\n    fac.facility_id,\n    current_timestamp() AS lastupdated\nFROM `dev`.`integrated`.`user_surveys` us\nleft join `dev`.`dbt-nstankus_enriched`.`enriched_device` d\n    on d.device = us.device\nleft join `dev`.`dbt-nstankus_enriched`.`enriched_user` u\n    on u.user = us.user\nleft join `dev`.`dbt-nstankus_enriched`.`enriched_facility` fac\n    on fac.facility = us.facility", "relation_name": "`dev`.`dbt-nstankus_curated`.`curated_fact_user_surveys`"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-04-14T18:20:01.736677Z", "completed_at": "2024-04-14T18:20:01.741894Z"}, {"name": "execute", "started_at": "2024-04-14T18:20:01.743584Z", "completed_at": "2024-04-14T18:20:08.021799Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 6.2896411418914795, "adapter_response": {"_message": "OK", "query_id": "01eefa8b-9c27-1106-9755-a98987368ee8"}, "message": "OK", "failures": null, "unique_id": "model.stridetechgo.enriched_fact_stg", "compiled": true, "compiled_code": "select\n    left_misuse_flag,\n    right_misuse_flag,\n    hip_misuse_flag,\n    total_misuse_flag,\n    -- Create metrics to track difference between identified misuse and triggered misuse\n    --- Missed triggers\n    CASE \n        WHEN left_vibration_trigger > 1 AND left_misuse_flag = 1 THEN 0\n            WHEN left_vibration_trigger > 1 AND left_misuse_flag = 0 THEN 0\n                WHEN left_vibration_trigger = 1 AND left_misuse_flag = 1 THEN 1\n        ELSE NULL\n    END AS left_missed_trigger,\n    CASE \n        WHEN right_vibration_trigger > 1 AND right_misuse_flag = 1 THEN 0\n            WHEN right_vibration_trigger > 1 AND right_misuse_flag = 0 THEN 0\n                WHEN right_vibration_trigger = 1 AND right_misuse_flag = 1 THEN 1\n        ELSE NULL\n    END AS right_missed_trigger,\n    CASE \n        WHEN hip_vibration_trigger > 1 AND hip_misuse_flag = 1 THEN 0\n            WHEN hip_vibration_trigger > 1 AND hip_misuse_flag = 0 THEN 0\n                WHEN hip_vibration_trigger = 1 AND hip_misuse_flag = 1 THEN 1\n        ELSE NULL\n    END AS hip_missed_trigger,\n    CASE \n        WHEN (left_vibration_trigger > 1 OR right_vibration_trigger > 1 OR hip_vibration_trigger > 1) AND total_misuse_flag = 1 THEN 0\n            WHEN (left_vibration_trigger > 1 OR right_vibration_trigger > 1 OR hip_vibration_trigger > 1) AND total_misuse_flag = 0 THEN 0\n                WHEN (left_vibration_trigger = 1 AND right_vibration_trigger = 1 AND hip_vibration_trigger = 1) AND total_misuse_flag = 1 THEN 1\n        ELSE NULL\n    END AS total_missed_trigger,\n    --- Trigger misfires\n    CASE \n        WHEN left_vibration_trigger = 3 AND left_misuse_flag = 1 THEN 0\n            WHEN left_vibration_trigger = 3 AND left_misuse_flag = 0 THEN 1\n                WHEN left_vibration_trigger < 3 AND left_misuse_flag = 1 THEN 0\n        ELSE NULL\n    END AS left_trigger_misfire,\n    CASE \n        WHEN right_vibration_trigger = 3 AND right_misuse_flag = 1 THEN 0\n            WHEN right_vibration_trigger = 3 AND right_misuse_flag = 0 THEN 1\n                WHEN right_vibration_trigger < 3 AND right_misuse_flag = 1 THEN 0\n        ELSE NULL\n    END AS right_trigger_misfire,\n    CASE \n        WHEN hip_vibration_trigger = 3 AND hip_misuse_flag = 1 THEN 0\n            WHEN hip_vibration_trigger = 3 AND hip_misuse_flag = 0 THEN 1\n                WHEN hip_vibration_trigger < 3 AND hip_misuse_flag = 1 THEN 0\n        ELSE NULL\n    END AS hip_trigger_misfire,\n    CASE \n        WHEN (left_vibration_trigger = 3 OR right_vibration_trigger = 3 OR hip_vibration_trigger = 3) AND total_misuse_flag = 1 THEN 0\n            WHEN (left_vibration_trigger = 3 OR right_vibration_trigger = 3 OR hip_vibration_trigger = 3) AND total_misuse_flag = 0 THEN 1\n                WHEN (left_vibration_trigger < 3 AND right_vibration_trigger < 3 AND hip_vibration_trigger < 3) AND total_misuse_flag = 1 THEN 0\n        ELSE NULL\n    END AS total_trigger_misfire,\n    -- Translate triggers to vibration\n    CASE \n        WHEN left_vibration_trigger == 3 AND activity_flag = 1 THEN 1\n            WHEN left_vibration_trigger IS NOT NULL THEN 0\n            ELSE NULL\n    END AS left_vibration_flag,\n    CASE \n        WHEN right_vibration_trigger == 3 AND activity_flag = 1 THEN 1\n            WHEN right_vibration_trigger IS NOT NULL THEN 0\n            ELSE NULL\n    END AS right_vibration_flag,\n    CASE \n        WHEN hip_vibration_trigger == 3 AND activity_flag = 1 THEN 1\n            WHEN hip_vibration_trigger IS NOT NULL THEN 0\n            ELSE NULL\n    END AS hip_vibration_flag,\n    CASE \n        WHEN (left_vibration_trigger == 3 OR right_vibration_trigger == 3 OR hip_vibration_trigger == 3) AND activity_flag = 1 THEN 1\n            WHEN COALESCE(left_vibration_flag, right_vibration_trigger, hip_vibration_trigger) IS NOT NULL THEN 0\n            ELSE NULL\n    END AS vibration_flag,\n    e.activity_flag AS activity_sec,\n    left_lbf,\n    right_lbf,\n    left_adc,\n    right_adc,\n    hip_distance,\n    force_threshold,\n    hip_distance_threshold,\n    baseline_left_adc,\n    baseline_right_adc,\n    left_adc_change,\n    right_adc_change,\n    fsr_length_adjustment,\n    -- PT metrics\n    start_abc_score,\n    start_tug_score_fastest_attempt,\n    start_tandem_balance_total_time,\n    start_successful_tandem_balance_positions,\n    start_functional_reach,\n    end_abc_score,\n    end_tug_score_fastest_attempt,\n    end_tandem_balance_score_total,\n    end_successful_tandem_balance_positions,\n    end_functional_reach,\n    -- Survey metrics\n    self_reported_physical_activity_per_week_hrs,\n    satisfied_with_activity,\n    fear_of_falling,\n    fall_history,\n    length_of_time_using_walker,\n    likes_using_walker,\n    received_walker_training,\n    description_of_changes_in_DLa,\n    would_purchase_stg,\n    how_much_would_you_pay,\n    would_recommend_stg,\n    stg_helped_learn_use_walker_better,\n    u.user_id,\n    h.hour_id,\n    t.trial_id,\n    d.device_id,\n    e.user_time,\n    e.extraction_time\nfrom `dev`.`dbt-nstankus_curated`.`curated_fact_stg` e\njoin `dev`.`dbt-nstankus_enriched`.`enriched_user` u\n    on u.user = e.user\njoin `dev`.`dbt-nstankus_enriched`.`enriched_hour` h\n    on h.week = e.week\n    and h.hour = date_trunc('hour', e.user_time)\njoin `dev`.`dbt-nstankus_enriched`.`enriched_trial` t\n    on t.trial_type = e.trial_type\njoin `dev`.`dbt-nstankus_enriched`.`enriched_device` d \n    on d.device = e.device\nleft join `dev`.`dbt-nstankus_curated`.`curated_fact_physical_therapy_evals` pt\n    on pt.user_id = u.user_id\n    and pt.device_id = d.device_id\nleft join `dev`.`dbt-nstankus_curated`.`curated_fact_user_surveys` us\n    on us.user_id = u.user_id\n    and us.device_id = d.device_id\n-- Flag for inactivity\nwhere e.activity_flag > 0", "relation_name": "`dev`.`dbt-nstankus_enriched`.`enriched_fact_stg`"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-04-14T18:20:08.029729Z", "completed_at": "2024-04-14T18:20:08.034410Z"}, {"name": "execute", "started_at": "2024-04-14T18:20:08.036305Z", "completed_at": "2024-04-14T18:20:11.934345Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 3.9094619750976562, "adapter_response": {"_message": "OK", "query_id": "01eefa8b-9ffb-1eda-b37c-2a9ca23039c8"}, "message": "OK", "failures": null, "unique_id": "model.stridetechgo.enriched_fact_stg_hourly", "compiled": true, "compiled_code": "select\n    count(1) as total_captured_sec,\n    CAST(SUM(activity_sec) AS NUMERIC) AS total_activity_sec,\n    TRY_CAST(AVG(left_lbf) AS NUMERIC) AS avg_left,\n    MAX(left_lbf) AS max_left,\n    MIN(left_lbf) AS min_left,\n    TRY_CAST(AVG(right_lbf) AS NUMERIC) AS avg_right,\n    MAX(right_lbf) AS max_right,\n    MIN(right_lbf) AS min_right,\n    CAST(AVG(force_threshold) AS DECIMAL(4,2)) AS force_thresh,\n    CAST(AVG(hip_distance) AS DECIMAL(4,2)) AS avg_hip_distance,\n    CAST(AVG(hip_distance_threshold) AS DECIMAL(4,2)) AS hip_thresh,\n    SUM(left_misuse_flag) AS left_misuse_event,\n    SUM(right_misuse_flag) AS right_misuse_event,\n    SUM(hip_misuse_flag) AS hip_misuse_event,\n    SUM(total_misuse_flag) AS total_misuse_event,\n    -- Product QA\n    SUM(left_missed_trigger) AS left_missed_trigger,\n    SUM(right_missed_trigger) AS right_missed_trigger,\n    SUM(hip_missed_trigger) AS hip_missed_trigger,\n    SUM(total_missed_trigger) AS total_missed_trigger,\n    SUM(left_trigger_misfire) AS left_trigger_misfire,\n    SUM(right_trigger_misfire) AS right_trigger_misfire,\n    SUM(hip_trigger_misfire) AS hip_trigger_misfire,\n    SUM(total_trigger_misfire) AS total_trigger_misfire,\n    AVG(left_lbf) + STDDEV(left_lbf) AS left_lbf_top_error,\n    AVG(left_lbf) - STDDEV(left_lbf) AS left_lbf_bottom_error,\n    AVG(right_lbf) + STDDEV(right_lbf) AS right_lbf_top_error,\n    AVG(right_lbf) - STDDEV(right_lbf) AS right_lbf_bottom_error,\n    AVG(hip_distance) + STDDEV(hip_distance) AS hip_distance_top_error,\n    AVG(hip_distance) - STDDEV(hip_distance) AS hip_distance_bottom_error,\n    TRY_CAST(AVG(left_adc) AS NUMERIC) AS avg_left_adc,\n    AVG(left_adc) + STDDEV(left_adc) AS left_adc_top_error,\n    AVG(left_adc) - STDDEV(left_adc) AS left_adc_bottom_error,\n    TRY_CAST(AVG(right_adc) AS NUMERIC) AS avg_right_adc,\n    AVG(right_adc) + STDDEV(right_adc) AS right_adc_top_error,\n    AVG(right_adc) - STDDEV(right_adc) AS right_adc_bottom_error,\n    -- PT metrics\n    MAX(start_abc_score) AS start_abc_score,\n    MAX(start_tug_score_fastest_attempt) AS start_tug_score_fastest_attempt,\n    MAX(start_tandem_balance_total_time) AS start_tandem_balance_total_time,\n    MAX(start_successful_tandem_balance_positions) AS start_successful_tandem_balance_positions,\n    MAX(start_functional_reach) AS start_functional_reach,\n    MAX(end_abc_score) AS end_abc_score,\n    MAX(end_tug_score_fastest_attempt) AS end_tug_score_fastest_attempt,\n    MAX(end_tandem_balance_score_total) AS end_tandem_balance_score_total,\n    MAX(end_successful_tandem_balance_positions) AS end_successful_tandem_balance_positions,\n    MAX(end_functional_reach) AS end_functional_reach,\n    -- Survey metrics\n    MAX(self_reported_physical_activity_per_week_hrs) AS self_reported_physical_activity_per_week_hrs,\n    MAX(satisfied_with_activity) AS satisfied_with_activity,\n    MAX(fear_of_falling) AS fear_of_falling,\n    MAX(fall_history) AS fall_history,\n    MAX(length_of_time_using_walker) AS length_of_time_using_walker,\n    MAX(likes_using_walker) AS likes_using_walker,\n    MAX(received_walker_training) AS received_walker_training,\n    MAX(description_of_changes_in_DLa) AS description_of_changes_in_DLa,\n    MAX(would_purchase_stg) AS would_purchase_stg,\n    MAX(how_much_would_you_pay) AS how_much_would_you_pay,\n    MAX(would_recommend_stg) AS would_recommend_stg,\n    MAX(stg_helped_learn_use_walker_better) AS stg_helped_learn_use_walker_better,\n    user_id,\n    device_id,\n    hour_id,\n    trial_id,\n    MAX(extraction_time) AS lastupdated\nfrom `dev`.`dbt-nstankus_enriched`.`enriched_fact_stg`\ngroup by hour_id, trial_id, user_id, device_id", "relation_name": "`dev`.`dbt-nstankus_enriched`.`enriched_fact_stg_hourly`"}], "elapsed_time": 60.51199269294739, "args": {"log_format_file": "debug", "log_file_max_bytes": 10485760, "log_path": "/Users/stankusnt/stg_full_pipeline/stg_dbt_pipeline/logs", "select": [], "printer_width": 80, "vars": {}, "exclude": [], "project_dir": "/Users/stankusnt/stg_full_pipeline/stg_dbt_pipeline", "send_anonymous_usage_stats": true, "introspect": true, "macro_debugging": false, "resource_types": [], "show_resource_report": false, "which": "build", "log_level": "info", "partial_parse_file_diff": true, "indirect_selection": "eager", "profiles_dir": "/Users/stankusnt/stg_full_pipeline/stg_dbt_pipeline", "use_colors": true, "defer": false, "cache_selected_only": false, "static_parser": true, "populate_cache": true, "enable_legacy_logger": false, "print": true, "warn_error_options": {"include": [], "exclude": []}, "use_colors_file": true, "version_check": true, "write_json": true, "show": false, "invocation_command": "dbt build", "log_format": "default", "log_level_file": "debug", "partial_parse": true, "include_saved_query": false, "favor_state": false, "strict_mode": false, "quiet": false}}