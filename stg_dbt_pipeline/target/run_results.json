{"metadata": {"dbt_schema_version": "https://schemas.getdbt.com/dbt/run-results/v5.json", "dbt_version": "1.7.11", "generated_at": "2024-04-24T21:52:28.252228Z", "invocation_id": "09a254fe-bd6e-4508-bcf1-c938823f2f2f", "env": {}}, "results": [{"status": "success", "timing": [{"name": "compile", "started_at": "2024-04-24T21:51:58.442991Z", "completed_at": "2024-04-24T21:51:58.481700Z"}, {"name": "execute", "started_at": "2024-04-24T21:51:58.491955Z", "completed_at": "2024-04-24T21:52:01.663827Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 3.257218599319458, "adapter_response": {"_message": "OK", "query_id": "01ef0284-e03a-17c4-a7e8-576b5570e8fc"}, "message": "OK", "failures": null, "unique_id": "model.stridetechgo.curated_device", "compiled": true, "compiled_code": "SELECT \n    device_id,\n    device_name,\n    fsr_length,\n    left_side_fsr_length,\n    right_side_fsr_length,\n    width,\n    file_path,\n    \n    extraction_time,\n    current_timestamp() AS last_updated\nFROM `dev`.`processed`.`device`", "relation_name": "`prod`.`curated`.`curated_device`"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-04-24T21:51:58.457163Z", "completed_at": "2024-04-24T21:51:58.483070Z"}, {"name": "execute", "started_at": "2024-04-24T21:51:58.523915Z", "completed_at": "2024-04-24T21:52:01.842707Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 3.4309589862823486, "adapter_response": {"_message": "OK", "query_id": "01ef0284-e039-15f7-a410-59d29e744248"}, "message": "OK", "failures": null, "unique_id": "model.stridetechgo.curated_facility", "compiled": true, "compiled_code": "SELECT \n    facility_id,\n    facility_name,\n    facility_contact,\n    file_path,\n    \n    extraction_time,\n    current_timestamp() AS last_updated\nFROM `dev`.`processed`.`facility`", "relation_name": "`prod`.`curated`.`curated_facility`"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-04-24T21:51:58.466237Z", "completed_at": "2024-04-24T21:51:58.484905Z"}, {"name": "execute", "started_at": "2024-04-24T21:51:58.536489Z", "completed_at": "2024-04-24T21:52:02.058281Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 3.643247127532959, "adapter_response": {"_message": "OK", "query_id": "01ef0284-e081-1442-b153-b444b31d08a4"}, "message": "OK", "failures": null, "unique_id": "model.stridetechgo.curated_session", "compiled": true, "compiled_code": "SELECT \n    session_id,\n    session_name,\n    session_type,\n    session_description,\n    session_start_time,\n    session_end_time,\n    file_path,\n    \n    extraction_time,\n    current_timestamp() AS last_updated\nFROM `dev`.`processed`.`session`", "relation_name": "`prod`.`curated`.`curated_session`"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-04-24T21:51:58.472156Z", "completed_at": "2024-04-24T21:51:58.486139Z"}, {"name": "execute", "started_at": "2024-04-24T21:51:58.544183Z", "completed_at": "2024-04-24T21:52:02.070328Z"}], "thread_id": "Thread-5 (worker)", "execution_time": 3.6579508781433105, "adapter_response": {"_message": "OK", "query_id": "01ef0284-e085-1a35-8075-40bfe4e4c482"}, "message": "OK", "failures": null, "unique_id": "model.stridetechgo.curated_time", "compiled": true, "compiled_code": "SELECT \ntime_id,\nhour,\nday,\nfile_path,\n\nextraction_time,\ncurrent_timestamp() AS last_updated\nFROM `dev`.`processed`.`time`", "relation_name": "`prod`.`curated`.`curated_time`"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-04-24T21:51:58.476537Z", "completed_at": "2024-04-24T21:51:58.487989Z"}, {"name": "execute", "started_at": "2024-04-24T21:51:58.550123Z", "completed_at": "2024-04-24T21:52:02.157125Z"}], "thread_id": "Thread-6 (worker)", "execution_time": 3.739759922027588, "adapter_response": {"_message": "OK", "query_id": "01ef0284-e084-1a36-abca-775b4dcde9cd"}, "message": "OK", "failures": null, "unique_id": "model.stridetechgo.curated_user", "compiled": true, "compiled_code": "SELECT \n    user_id,\n    user_alias,\n    physical_therapist_name,\n    walker_purchased_from,\n    walker_manufacturer,\n    self_reported_activity_level,\n    satisfied_with_activity,\n    fear_of_falling,\n    fall_history,\n    length_of_time_using_walker,\n    length_of_time_using_walker_units,\n    likes_using_walker,\n    received_walker_training,\n    description_of_changes,\n    would_purchase,\n    would_pay_how_much,\n    would_recommend,\n    improved_walker_use,\n    file_path,\n    extraction_time,\n    current_timestamp() AS last_updated\nFROM `dev`.`processed`.`user` f", "relation_name": "`prod`.`curated`.`curated_user`"}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2024-04-24T21:52:01.855612Z", "completed_at": "2024-04-24T21:52:01.875649Z"}, {"name": "execute", "started_at": "2024-04-24T21:52:01.877261Z", "completed_at": "2024-04-24T21:52:02.256036Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.4085381031036377, "adapter_response": {"_message": "OK", "query_id": "01ef0284-e1df-1e78-8ea2-7ded0a5a56c4"}, "message": null, "failures": 0, "unique_id": "test.stridetechgo.not_null_curated_device_device_id.d4e781dfbd", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect device_id\nfrom `prod`.`curated`.`curated_device`\nwhere device_id is null\n\n\n", "relation_name": null}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2024-04-24T21:52:02.109860Z", "completed_at": "2024-04-24T21:52:02.117922Z"}, {"name": "execute", "started_at": "2024-04-24T21:52:02.121363Z", "completed_at": "2024-04-24T21:52:02.513295Z"}], "thread_id": "Thread-5 (worker)", "execution_time": 0.4312019348144531, "adapter_response": {"_message": "OK", "query_id": "01ef0284-e202-1e11-b702-403df092c5a1"}, "message": null, "failures": 0, "unique_id": "test.stridetechgo.not_null_curated_facility_facility_id.16d1ecc1c3", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect facility_id\nfrom `prod`.`curated`.`curated_facility`\nwhere facility_id is null\n\n\n", "relation_name": null}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2024-04-24T21:52:02.086538Z", "completed_at": "2024-04-24T21:52:02.100260Z"}, {"name": "execute", "started_at": "2024-04-24T21:52:02.103647Z", "completed_at": "2024-04-24T21:52:02.670106Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.5978879928588867, "adapter_response": {"_message": "OK", "query_id": "01ef0284-e202-135b-b8bf-a2ca0f2c6d55"}, "message": null, "failures": 0, "unique_id": "test.stridetechgo.unique_curated_device_device_id.c1c1aa62eb", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    device_id as unique_field,\n    count(*) as n_records\n\nfrom `prod`.`curated`.`curated_device`\nwhere device_id is not null\ngroup by device_id\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2024-04-24T21:52:02.169538Z", "completed_at": "2024-04-24T21:52:02.176466Z"}, {"name": "execute", "started_at": "2024-04-24T21:52:02.178063Z", "completed_at": "2024-04-24T21:52:02.803505Z"}], "thread_id": "Thread-6 (worker)", "execution_time": 0.6520721912384033, "adapter_response": {"_message": "OK", "query_id": "01ef0284-e20d-1c9e-9748-af49cc34ecee"}, "message": null, "failures": 0, "unique_id": "test.stridetechgo.unique_curated_facility_facility_id.38591f3890", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    facility_id as unique_field,\n    count(*) as n_records\n\nfrom `prod`.`curated`.`curated_facility`\nwhere facility_id is not null\ngroup by facility_id\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2024-04-24T21:52:02.267802Z", "completed_at": "2024-04-24T21:52:02.275228Z"}, {"name": "execute", "started_at": "2024-04-24T21:52:02.276949Z", "completed_at": "2024-04-24T21:52:02.810482Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.5557379722595215, "adapter_response": {"_message": "OK", "query_id": "01ef0284-e219-1ca1-9b73-c8a46b5a57dd"}, "message": null, "failures": 0, "unique_id": "test.stridetechgo.not_null_curated_session_session_id.3ba2b023d2", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect session_id\nfrom `prod`.`curated`.`curated_session`\nwhere session_id is null\n\n\n", "relation_name": null}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2024-04-24T21:52:02.524983Z", "completed_at": "2024-04-24T21:52:02.532068Z"}, {"name": "execute", "started_at": "2024-04-24T21:52:02.533783Z", "completed_at": "2024-04-24T21:52:03.086227Z"}], "thread_id": "Thread-5 (worker)", "execution_time": 0.5695106983184814, "adapter_response": {"_message": "OK", "query_id": "01ef0284-e241-1cb0-946e-2f3f5474e73f"}, "message": null, "failures": 0, "unique_id": "test.stridetechgo.unique_curated_session_session_id.bb25b94cab", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    session_id as unique_field,\n    count(*) as n_records\n\nfrom `prod`.`curated`.`curated_session`\nwhere session_id is not null\ngroup by session_id\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2024-04-24T21:52:02.844563Z", "completed_at": "2024-04-24T21:52:02.852735Z"}, {"name": "execute", "started_at": "2024-04-24T21:52:02.859042Z", "completed_at": "2024-04-24T21:52:03.196126Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.3704679012298584, "adapter_response": {"_message": "OK", "query_id": "01ef0284-e274-165d-acfb-2dd616bf87f4"}, "message": null, "failures": 0, "unique_id": "test.stridetechgo.not_null_curated_user_user_id.2e20325cf4", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect user_id\nfrom `prod`.`curated`.`curated_user`\nwhere user_id is null\n\n\n", "relation_name": null}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2024-04-24T21:52:02.682724Z", "completed_at": "2024-04-24T21:52:02.799603Z"}, {"name": "execute", "started_at": "2024-04-24T21:52:02.804597Z", "completed_at": "2024-04-24T21:52:03.253952Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.5795950889587402, "adapter_response": {"_message": "OK", "query_id": "01ef0284-e26d-1668-a277-7a02eca84427"}, "message": null, "failures": 0, "unique_id": "test.stridetechgo.not_null_curated_time_time_id.f7556409fd", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect time_id\nfrom `prod`.`curated`.`curated_time`\nwhere time_id is null\n\n\n", "relation_name": null}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2024-04-24T21:52:02.838169Z", "completed_at": "2024-04-24T21:52:02.851823Z"}, {"name": "execute", "started_at": "2024-04-24T21:52:02.855034Z", "completed_at": "2024-04-24T21:52:03.337450Z"}], "thread_id": "Thread-6 (worker)", "execution_time": 0.5133888721466064, "adapter_response": {"_message": "OK", "query_id": "01ef0284-e273-113a-9e4d-542beefd82a7"}, "message": null, "failures": 0, "unique_id": "test.stridetechgo.unique_curated_time_time_id.9615d543e9", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    time_id as unique_field,\n    count(*) as n_records\n\nfrom `prod`.`curated`.`curated_time`\nwhere time_id is not null\ngroup by time_id\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2024-04-24T21:52:03.099030Z", "completed_at": "2024-04-24T21:52:03.106558Z"}, {"name": "execute", "started_at": "2024-04-24T21:52:03.108356Z", "completed_at": "2024-04-24T21:52:03.748920Z"}], "thread_id": "Thread-5 (worker)", "execution_time": 0.6584019660949707, "adapter_response": {"_message": "OK", "query_id": "01ef0284-e298-1a0f-9796-a14b17195505"}, "message": null, "failures": 0, "unique_id": "test.stridetechgo.unique_curated_user_user_id.75cd20d12f", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    user_id as unique_field,\n    count(*) as n_records\n\nfrom `prod`.`curated`.`curated_user`\nwhere user_id is not null\ngroup by user_id\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-04-24T21:52:01.676919Z", "completed_at": "2024-04-24T21:52:01.682225Z"}, {"name": "execute", "started_at": "2024-04-24T21:52:01.684016Z", "completed_at": "2024-04-24T21:52:04.544004Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 2.8768060207366943, "adapter_response": {"_message": "OK", "query_id": "01ef0284-e1f4-1430-ab42-30177c58f4ab"}, "message": "OK", "failures": null, "unique_id": "model.stridetechgo.curated_week", "compiled": true, "compiled_code": "SELECT \nweek_id,\nweek_name,\nweek_no,\nfile_path,\nextraction_time,\ncurrent_timestamp() AS last_updated\nFROM `dev`.`processed`.`week`", "relation_name": "`prod`.`curated`.`curated_week`"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-04-24T21:51:58.461675Z", "completed_at": "2024-04-24T21:51:58.483984Z"}, {"name": "execute", "started_at": "2024-04-24T21:51:58.530266Z", "completed_at": "2024-04-24T21:52:05.848620Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 7.4343812465667725, "adapter_response": {"_message": "OK", "query_id": "01ef0284-e078-1f8c-ba93-24230f4be6f1"}, "message": "OK", "failures": null, "unique_id": "model.stridetechgo.curated_fact_stg", "compiled": true, "compiled_code": "SELECT \n    device_time,\n    -- Metrics definition\n    CASE \n        WHEN left_lbf > force_threshold THEN 1\n            WHEN left_lbf IS NOT NULL THEN 0\n            ELSE NULL\n    END AS left_misuse_flag,\n    CASE \n        WHEN right_lbf > force_threshold THEN 1\n            WHEN right_lbf IS NOT NULL THEN 0\n            ELSE NULL\n    END AS right_misuse_flag,\n    CASE \n        WHEN hip_distance > hip_distance_threshold THEN 1\n            WHEN hip_distance IS NOT NULL THEN 0\n            ELSE NULL\n    END AS hip_misuse_flag,\n    CASE \n        WHEN (left_lbf > force_threshold OR right_lbf > force_threshold OR hip_distance > hip_distance_threshold) THEN 1\n            WHEN COALESCE(left_lbf, right_lbf, hip_distance) IS NOT NULL THEN 0\n            ELSE NULL\n    END AS total_misuse_flag,\n    -- Imposing range constraints on lbf\n    CASE \n        WHEN left_lbf < 0 THEN 0\n        WHEN left_lbf > 100 THEN 100\n        ELSE left_lbf\n    END AS left_lbf,\n    CASE \n        WHEN right_lbf < 0 THEN 0\n        WHEN right_lbf > 100 THEN 100\n        ELSE right_lbf\n    END AS right_lbf,\n    left_adc,\n    right_adc,\n    hip_distance,\n    left_vibration_trigger,\n    right_vibration_trigger,\n    hip_vibration_trigger,\n    force_threshold,\n    hip_distance_threshold,\n    baseline_left_adc,\n    baseline_right_adc,\n    left_adc_change,\n    right_adc_change,\n    accelerometer_motion_flag,\n    facility_id,\n    device_id,\n    time_id,\n    week_id,\n    user_id,\n    session_id,\n    file_path,\n    extraction_time,\n    current_timestamp() AS last_updated\nFROM `dev`.`processed`.`fact_stg_nodes`", "relation_name": "`prod`.`curated`.`curated_fact_stg`"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-04-24T21:52:03.767827Z", "completed_at": "2024-04-24T21:52:03.782669Z"}, {"name": "execute", "started_at": "2024-04-24T21:52:03.786109Z", "completed_at": "2024-04-24T21:52:07.587391Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 3.833193063735962, "adapter_response": {"_message": "OK", "query_id": "01ef0284-e346-181b-bb0e-efff90c2aa97"}, "message": "OK", "failures": null, "unique_id": "model.stridetechgo.curated_fact_physical_therapy_evals", "compiled": true, "compiled_code": "SELECT \n    NULL AS start_week,\n    NULL AS end_week,\n    start_abc_score,\n    start_tug_score_fastest_attempt,\n    start_tandem_balance_total_time,\n    start_successful_tandem_balance_positions,\n    start_functional_reach,\n    end_abc_score,\n    end_tug_score_fastest_attempt,\n    end_tandem_balance_score_total,\n    end_successful_tandem_balance_positions,\n    end_functional_reach,\n    d.device_id,\n    u.user_id,\n    fac.facility_id,\n    current_timestamp() AS last_updated\nfrom `prod`.`integrated`.`physical_therapy_evals` pt\nleft join `prod`.`curated`.`curated_device` d\n    on d.device_name = pt.device_name\nleft join `prod`.`curated`.`curated_user` u\n    on u.user_alias = pt.user_alias\nleft join `prod`.`curated`.`curated_facility` fac\n    on fac.facility_name = pt.facility_name", "relation_name": "`prod`.`curated`.`curated_fact_physical_therapy_evals`"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-04-24T21:52:03.774009Z", "completed_at": "2024-04-24T21:52:03.783559Z"}, {"name": "execute", "started_at": "2024-04-24T21:52:03.792733Z", "completed_at": "2024-04-24T21:52:07.901252Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 4.146260976791382, "adapter_response": {"_message": "OK", "query_id": "01ef0284-e346-17ec-add6-0651b6d17514"}, "message": "OK", "failures": null, "unique_id": "model.stridetechgo.curated_fact_user_surveys", "compiled": true, "compiled_code": "SELECT \n    us.self_reported_physical_activity_per_week_hrs,\n    us.satisfied_with_activity,\n    us.fear_of_falling,\n    us.fall_history,\n    us.length_of_time_using_walker,\n    us.likes_using_walker,\n    us.received_walker_training,\n    us.description_of_changes_in_DLa,\n    us.would_purchase_stg,\n    us.how_much_would_you_pay,\n    us.would_recommend_stg,\n    us.stg_helped_learn_use_walker_better,\n    d.device_id,\n    u.user_id,\n    fac.facility_id,\n    current_timestamp() AS last_updated\nFROM `prod`.`integrated`.`user_surveys` us\nleft join `prod`.`curated`.`curated_device` d\n    on d.device_name = us.device_name\nleft join `prod`.`curated`.`curated_user` u\n    on u.user_alias = us.user_alias\nleft join `prod`.`curated`.`curated_facility` fac\n    on fac.facility_name = us.facility_name", "relation_name": "`prod`.`curated`.`curated_fact_user_surveys`"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-04-24T21:52:05.888924Z", "completed_at": "2024-04-24T21:52:05.910138Z"}, {"name": "execute", "started_at": "2024-04-24T21:52:05.922778Z", "completed_at": "2024-04-24T21:52:09.655569Z"}], "thread_id": "Thread-6 (worker)", "execution_time": 3.796617031097412, "adapter_response": {"_message": "OK", "query_id": "01ef0284-e489-1d58-a4c0-595ee04b135b"}, "message": "OK", "failures": null, "unique_id": "model.stridetechgo.enriched_device", "compiled": true, "compiled_code": "SELECT DISTINCT\n    dev.device_id AS device_id,\n    dev.device_name AS device,\n    dev.fsr_length AS fsr_length,\n    dev.left_side_fsr_length AS left_side_fsr_length,\n    dev.right_side_fsr_length AS right_side_fsr_length,\n    dev.width,\n    dev.file_path,\n    dev.extraction_time,\n    current_timestamp() AS last_updated\nFROM `prod`.`curated`.`curated_device` dev\nLEFT JOIN `prod`.`curated`.`curated_fact_stg` stg\n    ON stg.device_id = dev.device_id\nLEFT JOIN `prod`.`integrated`.`physical_therapy_evals` pt\n    ON pt.device_name = dev.device_name\nLEFT JOIN `prod`.`integrated`.`user_surveys` s\n    ON s.device_name = dev.device_name", "relation_name": "`prod`.`enriched`.`enriched_device`"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-04-24T21:52:05.881893Z", "completed_at": "2024-04-24T21:52:05.907838Z"}, {"name": "execute", "started_at": "2024-04-24T21:52:05.911985Z", "completed_at": "2024-04-24T21:52:10.444634Z"}], "thread_id": "Thread-5 (worker)", "execution_time": 4.588198900222778, "adapter_response": {"_message": "OK", "query_id": "01ef0284-e489-1d22-a397-0a23f78155ef"}, "message": "OK", "failures": null, "unique_id": "model.stridetechgo.enriched_week", "compiled": true, "compiled_code": "SELECT DISTINCT\nw.week_id,\nw.week_name,\nw.week_no,\nw.file_path,\nw.extraction_time,\ncurrent_timestamp() AS last_updated\nFROM `prod`.`curated`.`curated_week` w\nJOIN `prod`.`curated`.`curated_fact_stg` stg\n    ON stg.week_id = w.week_id", "relation_name": "`prod`.`enriched`.`enriched_week`"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-04-24T21:52:05.900600Z", "completed_at": "2024-04-24T21:52:05.917174Z"}, {"name": "execute", "started_at": "2024-04-24T21:52:05.933706Z", "completed_at": "2024-04-24T21:52:10.750993Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 4.889264345169067, "adapter_response": {"_message": "OK", "query_id": "01ef0284-e488-1d53-a35e-8e4f2940bcf4"}, "message": "OK", "failures": null, "unique_id": "model.stridetechgo.enriched_hour", "compiled": true, "compiled_code": "SELECT DISTINCT\nt.time_id,\nt.hour,\nt.day,\nt.file_path,\nt.extraction_time,\ncurrent_timestamp() AS last_updated\nFROM `prod`.`curated`.`curated_time` t\nJOIN `prod`.`curated`.`curated_fact_stg` stg\n    ON stg.time_id = t.time_id", "relation_name": "`prod`.`enriched`.`enriched_hour`"}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2024-04-24T21:52:10.459588Z", "completed_at": "2024-04-24T21:52:10.469324Z"}, {"name": "execute", "started_at": "2024-04-24T21:52:10.471848Z", "completed_at": "2024-04-24T21:52:10.828479Z"}], "thread_id": "Thread-5 (worker)", "execution_time": 0.37830591201782227, "adapter_response": {"_message": "OK", "query_id": "01ef0284-e6fc-1ed0-856b-047fdae39d22"}, "message": null, "failures": 0, "unique_id": "test.stridetechgo.not_null_enriched_device_device_id.3e9e77ed3d", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect device_id\nfrom `prod`.`enriched`.`enriched_device`\nwhere device_id is null\n\n\n", "relation_name": null}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2024-04-24T21:52:10.841636Z", "completed_at": "2024-04-24T21:52:10.849195Z"}, {"name": "execute", "started_at": "2024-04-24T21:52:10.850890Z", "completed_at": "2024-04-24T21:52:11.222820Z"}], "thread_id": "Thread-5 (worker)", "execution_time": 0.3906898498535156, "adapter_response": {"_message": "OK", "query_id": "01ef0284-e735-1e7e-9d3b-09db55a4efa4"}, "message": null, "failures": 0, "unique_id": "test.stridetechgo.not_null_enriched_hour_time_id.35f47a1516", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect time_id\nfrom `prod`.`enriched`.`enriched_hour`\nwhere time_id is null\n\n\n", "relation_name": null}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2024-04-24T21:52:10.765411Z", "completed_at": "2024-04-24T21:52:10.774326Z"}, {"name": "execute", "started_at": "2024-04-24T21:52:10.776232Z", "completed_at": "2024-04-24T21:52:11.423358Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.6666951179504395, "adapter_response": {"_message": "OK", "query_id": "01ef0284-e72b-1f31-9c84-162576727953"}, "message": null, "failures": 0, "unique_id": "test.stridetechgo.unique_enriched_device_device_id.923130e507", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    device_id as unique_field,\n    count(*) as n_records\n\nfrom `prod`.`enriched`.`enriched_device`\nwhere device_id is not null\ngroup by device_id\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-04-24T21:52:07.603290Z", "completed_at": "2024-04-24T21:52:07.610602Z"}, {"name": "execute", "started_at": "2024-04-24T21:52:07.612240Z", "completed_at": "2024-04-24T21:52:12.147694Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 4.555376052856445, "adapter_response": {"_message": "OK", "query_id": "01ef0284-e56f-1a7a-ad87-a8fa9e0c267c"}, "message": "OK", "failures": null, "unique_id": "model.stridetechgo.enriched_trial", "compiled": true, "compiled_code": "SELECT DISTINCT\n    ssh.session_id,\n    session_name,\n    session_type AS trial_type,\n    session_description,\n    session_start_time,\n    session_end_time,\n    ssh.file_path,\n    ssh.extraction_time,\n    current_timestamp() AS last_updated\nFROM `prod`.`curated`.`curated_session` ssh\nJOIN `prod`.`curated`.`curated_fact_stg` stg\n    ON ssh.session_id = stg.session_id", "relation_name": "`prod`.`enriched`.`enriched_trial`"}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2024-04-24T21:52:12.162617Z", "completed_at": "2024-04-24T21:52:12.174718Z"}, {"name": "execute", "started_at": "2024-04-24T21:52:12.176446Z", "completed_at": "2024-04-24T21:52:12.763002Z"}], "thread_id": "Thread-5 (worker)", "execution_time": 0.6099741458892822, "adapter_response": {"_message": "OK", "query_id": "01ef0284-e800-193d-935e-78585f6d7565"}, "message": null, "failures": 0, "unique_id": "test.stridetechgo.not_null_enriched_trial_session_id.0ebe8b7c17", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect session_id\nfrom `prod`.`enriched`.`enriched_trial`\nwhere session_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-04-24T21:52:07.915576Z", "completed_at": "2024-04-24T21:52:07.923763Z"}, {"name": "execute", "started_at": "2024-04-24T21:52:07.925616Z", "completed_at": "2024-04-24T21:52:13.521589Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 5.614943027496338, "adapter_response": {"_message": "OK", "query_id": "01ef0284-e5c9-19e9-9dfc-c4332041f792"}, "message": "OK", "failures": null, "unique_id": "model.stridetechgo.enriched_user", "compiled": true, "compiled_code": "SELECT DISTINCT\n    u.user_id,\n    u.user_alias,\n    RIGHT(u.user_alias, LENGTH(u.user_alias) - 1) AS user_no,\n    u.physical_therapist_name,\n    u.walker_purchased_from,\n    u.walker_manufacturer,\n    u.self_reported_activity_level,\n    u.satisfied_with_activity,\n    u.fear_of_falling,\n    u.fall_history,\n    u.length_of_time_using_walker,\n    u.length_of_time_using_walker_units,\n    u.likes_using_walker,\n    u.received_walker_training,\n    u.description_of_changes,\n    u.would_purchase,\n    u.would_pay_how_much,\n    u.would_recommend,\n    u.improved_walker_use,\n    u.file_path,\n    u.extraction_time,\n    current_timestamp() AS last_updated\nFROM `prod`.`curated`.`curated_user` u\nJOIN `prod`.`curated`.`curated_fact_stg` stg\n    ON u.user_id = stg.user_id", "relation_name": "`prod`.`enriched`.`enriched_user`"}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2024-04-24T21:52:13.535667Z", "completed_at": "2024-04-24T21:52:13.544698Z"}, {"name": "execute", "started_at": "2024-04-24T21:52:13.546463Z", "completed_at": "2024-04-24T21:52:14.038327Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.5114178657531738, "adapter_response": {"_message": "OK", "query_id": "01ef0284-e8d1-1766-83cf-9f31976145e1"}, "message": null, "failures": 0, "unique_id": "test.stridetechgo.unique_enriched_user_user_id.7903fc603b", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    user_id as unique_field,\n    count(*) as n_records\n\nfrom `prod`.`enriched`.`enriched_user`\nwhere user_id is not null\ngroup by user_id\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-04-24T21:52:05.894977Z", "completed_at": "2024-04-24T21:52:05.911041Z"}, {"name": "execute", "started_at": "2024-04-24T21:52:05.928305Z", "completed_at": "2024-04-24T21:52:16.174365Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 10.312876224517822, "adapter_response": {"_message": "OK", "query_id": "01ef0284-e489-100d-8cea-31ad5d358562"}, "message": "OK", "failures": null, "unique_id": "model.stridetechgo.enriched_facility", "compiled": true, "compiled_code": "SELECT DISTINCT\n    COALESCE(f.facility_name, pte.facility_name) AS facility,\n    f.facility_id,\n    f.facility_contact,\n    f.file_path,\n    f.extraction_time,\n    current_timestamp() AS last_updated\nFROM `prod`.`curated`.`curated_facility` f\nJOIN `prod`.`curated`.`curated_fact_stg` stg\n    ON stg.facility_id = f.facility_id\nLEFT JOIN `prod`.`integrated`.`physical_therapy_evals` pte\n    ON f.facility_name = pte.facility_name", "relation_name": "`prod`.`enriched`.`enriched_facility`"}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2024-04-24T21:52:16.196751Z", "completed_at": "2024-04-24T21:52:16.212679Z"}, {"name": "execute", "started_at": "2024-04-24T21:52:16.216300Z", "completed_at": "2024-04-24T21:52:16.613911Z"}], "thread_id": "Thread-5 (worker)", "execution_time": 0.4323551654815674, "adapter_response": {"_message": "OK", "query_id": "01ef0284-ea6a-1360-88a5-1b752a16dfb2"}, "message": null, "failures": 0, "unique_id": "test.stridetechgo.not_null_enriched_facility_facility_id.5683237b68", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect facility_id\nfrom `prod`.`enriched`.`enriched_facility`\nwhere facility_id is null\n\n\n", "relation_name": null}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2024-04-24T21:52:16.204624Z", "completed_at": "2024-04-24T21:52:16.213626Z"}, {"name": "execute", "started_at": "2024-04-24T21:52:16.221165Z", "completed_at": "2024-04-24T21:52:16.717864Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.5349700450897217, "adapter_response": {"_message": "OK", "query_id": "01ef0284-ea6b-155c-ad2f-fa230ceb9f72"}, "message": null, "failures": 0, "unique_id": "test.stridetechgo.unique_enriched_facility_facility_id.a65163b9e3", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    facility_id as unique_field,\n    count(*) as n_records\n\nfrom `prod`.`enriched`.`enriched_facility`\nwhere facility_id is not null\ngroup by facility_id\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-04-24T21:52:09.670031Z", "completed_at": "2024-04-24T21:52:09.680167Z"}, {"name": "execute", "started_at": "2024-04-24T21:52:09.681849Z", "completed_at": "2024-04-24T21:52:20.072758Z"}], "thread_id": "Thread-6 (worker)", "execution_time": 10.411872386932373, "adapter_response": {"_message": "OK", "query_id": "01ef0284-e6bf-13bc-a093-9c78878eea24"}, "message": "OK", "failures": null, "unique_id": "model.stridetechgo.enriched_fact_stg", "compiled": true, "compiled_code": "select\n    left_misuse_flag,\n    right_misuse_flag,\n    hip_misuse_flag,\n    total_misuse_flag,\n    -- Create metrics to track difference between identified misuse and triggered misuse\n    --- Missed triggers\n    CASE \n        WHEN left_vibration_trigger > 1 AND left_misuse_flag = 1 THEN 0\n            WHEN left_vibration_trigger > 1 AND left_misuse_flag = 0 THEN 0\n                WHEN left_vibration_trigger = 1 AND left_misuse_flag = 1 THEN 1\n        ELSE NULL\n    END AS left_missed_trigger,\n    CASE \n        WHEN right_vibration_trigger > 1 AND right_misuse_flag = 1 THEN 0\n            WHEN right_vibration_trigger > 1 AND right_misuse_flag = 0 THEN 0\n                WHEN right_vibration_trigger = 1 AND right_misuse_flag = 1 THEN 1\n        ELSE NULL\n    END AS right_missed_trigger,\n    CASE \n        WHEN hip_vibration_trigger > 1 AND hip_misuse_flag = 1 THEN 0\n            WHEN hip_vibration_trigger > 1 AND hip_misuse_flag = 0 THEN 0\n                WHEN hip_vibration_trigger = 1 AND hip_misuse_flag = 1 THEN 1\n        ELSE NULL\n    END AS hip_missed_trigger,\n    CASE \n        WHEN (left_vibration_trigger > 1 OR right_vibration_trigger > 1 OR hip_vibration_trigger > 1) AND total_misuse_flag = 1 THEN 0\n            WHEN (left_vibration_trigger > 1 OR right_vibration_trigger > 1 OR hip_vibration_trigger > 1) AND total_misuse_flag = 0 THEN 0\n                WHEN (left_vibration_trigger = 1 AND right_vibration_trigger = 1 AND hip_vibration_trigger = 1) AND total_misuse_flag = 1 THEN 1\n        ELSE NULL\n    END AS total_missed_trigger,\n    --- Trigger misfires\n    CASE \n        WHEN left_vibration_trigger = 3 AND left_misuse_flag = 1 THEN 0\n            WHEN left_vibration_trigger = 3 AND left_misuse_flag = 0 THEN 1\n                WHEN left_vibration_trigger < 3 AND left_misuse_flag = 1 THEN 0\n        ELSE NULL\n    END AS left_trigger_misfire,\n    CASE \n        WHEN right_vibration_trigger = 3 AND right_misuse_flag = 1 THEN 0\n            WHEN right_vibration_trigger = 3 AND right_misuse_flag = 0 THEN 1\n                WHEN right_vibration_trigger < 3 AND right_misuse_flag = 1 THEN 0\n        ELSE NULL\n    END AS right_trigger_misfire,\n    CASE \n        WHEN hip_vibration_trigger = 3 AND hip_misuse_flag = 1 THEN 0\n            WHEN hip_vibration_trigger = 3 AND hip_misuse_flag = 0 THEN 1\n                WHEN hip_vibration_trigger < 3 AND hip_misuse_flag = 1 THEN 0\n        ELSE NULL\n    END AS hip_trigger_misfire,\n    CASE \n        WHEN (left_vibration_trigger = 3 OR right_vibration_trigger = 3 OR hip_vibration_trigger = 3) AND total_misuse_flag = 1 THEN 0\n            WHEN (left_vibration_trigger = 3 OR right_vibration_trigger = 3 OR hip_vibration_trigger = 3) AND total_misuse_flag = 0 THEN 1\n                WHEN (left_vibration_trigger < 3 AND right_vibration_trigger < 3 AND hip_vibration_trigger < 3) AND total_misuse_flag = 1 THEN 0\n        ELSE NULL\n    END AS total_trigger_misfire,\n    -- Translate triggers to vibration\n    CASE \n        WHEN left_vibration_trigger == 3  THEN 1\n            WHEN left_vibration_trigger IS NOT NULL THEN 0\n            ELSE NULL\n    END AS left_vibration_flag,\n    CASE \n        WHEN right_vibration_trigger == 3  THEN 1\n            WHEN right_vibration_trigger IS NOT NULL THEN 0\n            ELSE NULL\n    END AS right_vibration_flag,\n    CASE \n        WHEN hip_vibration_trigger == 3  THEN 1\n            WHEN hip_vibration_trigger IS NOT NULL THEN 0\n            ELSE NULL\n    END AS hip_vibration_flag,\n    CASE \n        WHEN (left_vibration_trigger == 3 OR right_vibration_trigger == 3 OR hip_vibration_trigger == 3)  THEN 1\n            WHEN COALESCE(left_vibration_flag, right_vibration_trigger, hip_vibration_trigger) IS NOT NULL THEN 0\n            ELSE NULL\n    END AS vibration_flag,\n    left_lbf,\n    right_lbf,\n    left_adc,\n    right_adc,\n    hip_distance,\n    force_threshold,\n    hip_distance_threshold,\n    baseline_left_adc,\n    baseline_right_adc,\n    left_adc_change,\n    right_adc_change,\n    d.fsr_length,\n    -- PT metrics\n    pt.start_abc_score,\n    pt.start_tug_score_fastest_attempt,\n    pt.start_tandem_balance_total_time,\n    pt.start_successful_tandem_balance_positions,\n    pt.start_functional_reach,\n    pt.end_abc_score,\n    pt.end_tug_score_fastest_attempt,\n    pt.end_tandem_balance_score_total,\n    pt.end_successful_tandem_balance_positions,\n    pt.end_functional_reach,\n    -- Survey metrics\n    us.self_reported_physical_activity_per_week_hrs,\n    us.satisfied_with_activity,\n    us.fear_of_falling,\n    us.fall_history,\n    us.length_of_time_using_walker,\n    us.likes_using_walker,\n    us.received_walker_training,\n    us.description_of_changes_in_DLa,\n    us.would_purchase_stg,\n    us.how_much_would_you_pay,\n    us.would_recommend_stg,\n    us.stg_helped_learn_use_walker_better,\n    f.facility_id,\n    u.user_id,\n    t.time_id,\n    w.week_id,\n    s.session_id,\n    d.device_id,\n    e.extraction_time,\n    current_timestamp() AS last_updated\nfrom `prod`.`curated`.`curated_fact_stg` e\njoin `prod`.`curated`.`curated_user` u\n    on u.user_id = e.user_id\njoin `prod`.`curated`.`curated_time` t\n    on t.time_id = e.time_id\njoin `prod`.`curated`.`curated_week` w\n    on w.week_id = e.week_id\njoin `prod`.`curated`.`curated_session` s\n    on s.session_id = e.session_id\njoin `prod`.`curated`.`curated_device` d \n    on d.device_id = e.device_id\njoin `prod`.`curated`.`curated_facility` f\n    on f.facility_id = e.facility_id\nleft join `prod`.`curated`.`curated_fact_physical_therapy_evals` pt\n    on pt.user_id = u.user_id\n    and pt.device_id = d.device_id\nleft join `prod`.`curated`.`curated_fact_user_surveys` us\n    on us.user_id = u.user_id\n    and us.device_id = d.device_id", "relation_name": "`prod`.`enriched`.`enriched_fact_stg`"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-04-24T21:52:20.086937Z", "completed_at": "2024-04-24T21:52:20.095055Z"}, {"name": "execute", "started_at": "2024-04-24T21:52:20.116571Z", "completed_at": "2024-04-24T21:52:27.036829Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 6.958906173706055, "adapter_response": {"_message": "OK", "query_id": "01ef0284-ed03-1912-8733-c5326caf4505"}, "message": "OK", "failures": null, "unique_id": "model.stridetechgo.enriched_fact_stg_hourly", "compiled": true, "compiled_code": "select\n    count(1) as total_captured_sec,\n    TRY_CAST(AVG(left_lbf) AS NUMERIC) AS avg_left,\n    MAX(left_lbf) AS max_left,\n    MIN(left_lbf) AS min_left,\n    TRY_CAST(AVG(right_lbf) AS NUMERIC) AS avg_right,\n    MAX(right_lbf) AS max_right,\n    MIN(right_lbf) AS min_right,\n    CAST(AVG(force_threshold) AS DECIMAL(4,2)) AS force_thresh,\n    CAST(AVG(hip_distance) AS DECIMAL(4,2)) AS avg_hip_distance,\n    CAST(AVG(hip_distance_threshold) AS DECIMAL(4,2)) AS hip_thresh,\n    SUM(left_misuse_flag) AS left_misuse_event,\n    SUM(right_misuse_flag) AS right_misuse_event,\n    SUM(hip_misuse_flag) AS hip_misuse_event,\n    SUM(total_misuse_flag) AS total_misuse_event,\n    -- Product QA\n    SUM(left_missed_trigger) AS left_missed_trigger,\n    SUM(right_missed_trigger) AS right_missed_trigger,\n    SUM(hip_missed_trigger) AS hip_missed_trigger,\n    SUM(total_missed_trigger) AS total_missed_trigger,\n    SUM(left_trigger_misfire) AS left_trigger_misfire,\n    SUM(right_trigger_misfire) AS right_trigger_misfire,\n    SUM(hip_trigger_misfire) AS hip_trigger_misfire,\n    SUM(total_trigger_misfire) AS total_trigger_misfire,\n    AVG(left_lbf) + STDDEV(left_lbf) AS left_lbf_top_error,\n    AVG(left_lbf) - STDDEV(left_lbf) AS left_lbf_bottom_error,\n    AVG(right_lbf) + STDDEV(right_lbf) AS right_lbf_top_error,\n    AVG(right_lbf) - STDDEV(right_lbf) AS right_lbf_bottom_error,\n    AVG(hip_distance) + STDDEV(hip_distance) AS hip_distance_top_error,\n    AVG(hip_distance) - STDDEV(hip_distance) AS hip_distance_bottom_error,\n    TRY_CAST(AVG(left_adc) AS NUMERIC) AS avg_left_adc,\n    AVG(left_adc) + STDDEV(left_adc) AS left_adc_top_error,\n    AVG(left_adc) - STDDEV(left_adc) AS left_adc_bottom_error,\n    TRY_CAST(AVG(right_adc) AS NUMERIC) AS avg_right_adc,\n    AVG(right_adc) + STDDEV(right_adc) AS right_adc_top_error,\n    AVG(right_adc) - STDDEV(right_adc) AS right_adc_bottom_error,\n    -- PT metrics\n    MAX(start_abc_score) AS start_abc_score,\n    MAX(start_tug_score_fastest_attempt) AS start_tug_score_fastest_attempt,\n    MAX(start_tandem_balance_total_time) AS start_tandem_balance_total_time,\n    MAX(start_successful_tandem_balance_positions) AS start_successful_tandem_balance_positions,\n    MAX(start_functional_reach) AS start_functional_reach,\n    MAX(end_abc_score) AS end_abc_score,\n    MAX(end_tug_score_fastest_attempt) AS end_tug_score_fastest_attempt,\n    MAX(end_tandem_balance_score_total) AS end_tandem_balance_score_total,\n    MAX(end_successful_tandem_balance_positions) AS end_successful_tandem_balance_positions,\n    MAX(end_functional_reach) AS end_functional_reach,\n    -- Survey metrics\n    MAX(self_reported_physical_activity_per_week_hrs) AS self_reported_physical_activity_per_week_hrs,\n    MAX(satisfied_with_activity) AS satisfied_with_activity,\n    MAX(fear_of_falling) AS fear_of_falling,\n    MAX(fall_history) AS fall_history,\n    MAX(length_of_time_using_walker) AS length_of_time_using_walker,\n    MAX(likes_using_walker) AS likes_using_walker,\n    MAX(received_walker_training) AS received_walker_training,\n    MAX(description_of_changes_in_DLa) AS description_of_changes_in_DLa,\n    MAX(would_purchase_stg) AS would_purchase_stg,\n    MAX(how_much_would_you_pay) AS how_much_would_you_pay,\n    MAX(would_recommend_stg) AS would_recommend_stg,\n    MAX(stg_helped_learn_use_walker_better) AS stg_helped_learn_use_walker_better,\n    facility_id,\n    user_id,\n    device_id,\n    time_id,\n    week_id,\n    session_id,\n    MAX(extraction_time) AS extraction_time,\n    current_timestamp() AS last_updated\nfrom `prod`.`enriched`.`enriched_fact_stg`\ngroup by facility_id, time_id, week_id, session_id, user_id, device_id", "relation_name": "`prod`.`enriched`.`enriched_fact_stg_hourly`"}], "elapsed_time": 31.242711067199707, "args": {"show": false, "log_format": "default", "print": true, "send_anonymous_usage_stats": true, "indirect_selection": "eager", "defer": false, "introspect": true, "log_path": "/Users/stankusnt/stg_full_pipeline/stg_dbt_pipeline/logs", "strict_mode": false, "macro_debugging": false, "target": "prod", "vars": {}, "printer_width": 80, "warn_error_options": {"include": [], "exclude": []}, "partial_parse": true, "populate_cache": true, "static_parser": true, "cache_selected_only": false, "exclude": [], "enable_legacy_logger": false, "use_colors_file": true, "include_saved_query": false, "log_file_max_bytes": 10485760, "partial_parse_file_diff": true, "profiles_dir": "/Users/stankusnt/stg_full_pipeline/stg_dbt_pipeline", "invocation_command": "dbt build --target=prod", "version_check": true, "select": [], "show_resource_report": false, "project_dir": "/Users/stankusnt/stg_full_pipeline/stg_dbt_pipeline", "resource_types": [], "write_json": true, "use_colors": true, "quiet": false, "log_level": "info", "log_format_file": "debug", "log_level_file": "debug", "which": "build", "favor_state": false}}