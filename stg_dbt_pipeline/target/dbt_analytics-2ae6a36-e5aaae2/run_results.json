{"metadata": {"dbt_schema_version": "https://schemas.getdbt.com/dbt/run-results/v5.json", "dbt_version": "1.7.11", "generated_at": "2024-04-09T21:18:44.179724Z", "invocation_id": "efe879a0-6cb1-4c96-9083-c11b84d32fdb", "env": {}}, "results": [{"status": "success", "timing": [{"name": "compile", "started_at": "2024-04-09T21:17:42.716040Z", "completed_at": "2024-04-09T21:17:42.720035Z"}, {"name": "execute", "started_at": "2024-04-09T21:17:42.722911Z", "completed_at": "2024-04-09T21:17:57.182822Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 14.578635931015015, "adapter_response": {"_message": "OK", "query_id": "01eef6b6-9b83-193d-89f2-6c78e138bcc7"}, "message": "OK", "failures": null, "unique_id": "model.stridetechgo.enriched_facility", "compiled": true, "compiled_code": "SELECT \n    facility,\n    md5(facility) AS facility_id,\n    current_timestamp() AS lastupdated\nFROM `dev`.`integrated`.`physical_therapy_evals`\nGROUP BY \n    facility,\n    md5(facility)", "relation_name": "`dev`.`dbt-nstankus_enriched`.`enriched_facility`"}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2024-04-09T21:17:57.294519Z", "completed_at": "2024-04-09T21:17:57.318122Z"}, {"name": "execute", "started_at": "2024-04-09T21:17:57.336608Z", "completed_at": "2024-04-09T21:17:58.653978Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 1.4653759002685547, "adapter_response": {"_message": "OK", "query_id": "01eef6b6-a345-19bb-8b3b-df668ce339d8"}, "message": null, "failures": 0, "unique_id": "test.stridetechgo.not_null_enriched_facility_facility_id.5683237b68", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect facility_id\nfrom `dev`.`dbt-nstankus_enriched`.`enriched_facility`\nwhere facility_id is null\n\n\n", "relation_name": null}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2024-04-09T21:17:57.308453Z", "completed_at": "2024-04-09T21:17:57.317113Z"}, {"name": "execute", "started_at": "2024-04-09T21:17:57.320452Z", "completed_at": "2024-04-09T21:17:58.740060Z"}], "thread_id": "Thread-5 (worker)", "execution_time": 1.5526890754699707, "adapter_response": {"_message": "OK", "query_id": "01eef6b6-a347-1ef5-a65d-c6f20ea20dcc"}, "message": null, "failures": 0, "unique_id": "test.stridetechgo.unique_enriched_facility_facility_id.a65163b9e3", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    facility_id as unique_field,\n    count(*) as n_records\n\nfrom `dev`.`dbt-nstankus_enriched`.`enriched_facility`\nwhere facility_id is not null\ngroup by facility_id\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-04-09T21:17:42.707969Z", "completed_at": "2024-04-09T21:17:42.720860Z"}, {"name": "execute", "started_at": "2024-04-09T21:17:42.725645Z", "completed_at": "2024-04-09T21:18:10.189232Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 27.580244064331055, "adapter_response": {"_message": "OK", "query_id": "01eef6b6-9b80-17da-aca0-29ef8e2f2a11"}, "message": "OK", "failures": null, "unique_id": "model.stridetechgo.curated_fact_stg", "compiled": true, "compiled_code": "SELECT \n    -- Timestamp extrapolation\n    CAST(from_unixtime( -- Convert from unixtime back to UTC\n        (unix_timestamp(device_time) -- Convert timestamp to sec from ms\n        - MIN(unix_timestamp(device_time)) OVER (PARTITION BY user, week)) -- Subtract by min timestamp over user/week\n        + start_time)  -- Add start time for user/week \n    AS timestamp) AS user_time, \n    CAST(unix_timestamp(device_time) -- Convert timestamp to sec from ms\n        - MIN(unix_timestamp(device_time)) OVER (PARTITION BY user, week) -- Subtract by min timestamp over user/week\n    AS timestamp) AS session_time,\n    -- Metrics definition\n    CASE \n        WHEN left_vibration_trigger = 3 AND activity_flag = 1 THEN 1\n            WHEN left_vibration_trigger IS NOT NULL THEN 0\n            ELSE NULL\n    END AS left_misuse_flag,\n    CASE \n        WHEN right_vibration_trigger = 3 AND activity_flag = 1 THEN 1\n            WHEN right_vibration_trigger IS NOT NULL THEN 0\n            ELSE NULL\n    END AS right_misuse_flag,\n    CASE \n        WHEN hip_vibration_trigger = 3 AND activity_flag = 1 THEN 1\n            WHEN hip_vibration_trigger IS NOT NULL THEN 0\n            ELSE NULL\n    END AS hip_misuse_flag,\n    CASE \n        WHEN (left_vibration_trigger = 3 OR right_vibration_trigger = 3 OR hip_vibration_trigger = 3) AND activity_flag = 1 THEN 1\n            WHEN COALESCE(left_vibration_trigger, right_vibration_trigger, hip_vibration_trigger) IS NOT NULL THEN 0\n            ELSE NULL\n    END AS total_misuse_flag,\n    activity_flag,\n    -- Imposing range constraints on lbf\n    CASE \n        WHEN left_lbf < 0 THEN 0\n        WHEN left_lbf > 100 THEN 100\n        ELSE left_lbf\n    END AS left_lbf,\n    CASE \n        WHEN right_lbf < 0 THEN 0\n        WHEN right_lbf > 100 THEN 100\n        ELSE right_lbf\n    END AS right_lbf,\n    left_adc,\n    right_adc,\n    hip_distance,\n    left_vibration_trigger,\n    right_vibration_trigger,\n    hip_vibration_trigger,\n    force_threshold,\n    hip_distance_threshold,\n    baseline_left_adc,\n    baseline_right_adc,\n    left_adc_change,\n    right_adc_change,\n    accelerometer_motion_flag,\n    file_path,\n    device,\n    week,\n    file,\n    user,\n    fsr_length_adjustment,\n    trial_type,\n    run_id,\n    extraction_time as extraction_time\nFROM `dev`.`integrated`.`stg_nodes` base", "relation_name": "`dev`.`dbt-nstankus_curated`.`curated_fact_stg`"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-04-09T21:18:10.317275Z", "completed_at": "2024-04-09T21:18:10.325667Z"}, {"name": "execute", "started_at": "2024-04-09T21:18:10.344709Z", "completed_at": "2024-04-09T21:18:19.006721Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 8.811093807220459, "adapter_response": {"_message": "OK", "query_id": "01eef6b6-ab83-1234-ac49-10a6b582aeae"}, "message": "OK", "failures": null, "unique_id": "model.stridetechgo.enriched_user", "compiled": true, "compiled_code": "SELECT DISTINCT \n    COALESCE(f.user, pt.user, s.user) AS user,\n    s.age,\n    s.gender,\n    s.height_in,\n    s.weight_lbs,\n    s.dob,\n    s.walker_trainer,\n    s.walker_purchased_from,\n    s.walker_manufacturer,\n    md5(COALESCE(f.user, pt.user, s.user)) AS user_id,\n    CAST(\n        RIGHT(\n            COALESCE(f.user, pt.user, s.user),\n            LENGTH(COALESCE(f.user, pt.user, s.user)) - 1\n        ) AS INTEGER)\n     AS user_no,\n    current_timestamp() AS lastupdated\nFROM `dev`.`dbt-nstankus_curated`.`curated_fact_stg` f\nLEFT JOIN `dev`.`integrated`.`physical_therapy_evals` pt\n    ON pt.user = f.user\nLEFT JOIN `dev`.`integrated`.`user_surveys` s\n    ON s.user = f.user\nWHERE COALESCE(f.user, pt.user, s.user) IS NOT NULL", "relation_name": "`dev`.`dbt-nstankus_enriched`.`enriched_user`"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-04-09T21:18:10.302559Z", "completed_at": "2024-04-09T21:18:10.322744Z"}, {"name": "execute", "started_at": "2024-04-09T21:18:10.331786Z", "completed_at": "2024-04-09T21:18:19.837072Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 9.654776096343994, "adapter_response": {"_message": "OK", "query_id": "01eef6b6-ab7e-1db2-92ef-9a8930d3f760"}, "message": "OK", "failures": null, "unique_id": "model.stridetechgo.enriched_hour", "compiled": true, "compiled_code": "SELECT \n    week,\n    cast(substring(week, len(week)-1, len(week)) AS int) AS week_num,\n    date_trunc('day', user_time) AS day,\n    date_trunc('hour', user_time) AS hour,\n    md5(date_trunc('hour', user_time) || week) AS hour_id,\n    current_timestamp() AS lastupdated\nFROM `dev`.`dbt-nstankus_curated`.`curated_fact_stg`\nGROUP BY \n    week,\n    date_trunc('day', user_time),\n    date_trunc('hour', user_time),\n    md5(date_trunc('hour', user_time) || week)", "relation_name": "`dev`.`dbt-nstankus_enriched`.`enriched_hour`"}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2024-04-09T21:18:19.118762Z", "completed_at": "2024-04-09T21:18:19.130046Z"}, {"name": "execute", "started_at": "2024-04-09T21:18:19.135577Z", "completed_at": "2024-04-09T21:18:20.089466Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 1.0698199272155762, "adapter_response": {"_message": "OK", "query_id": "01eef6b6-b03a-170d-a286-79d1bb0401a2"}, "message": null, "failures": 0, "unique_id": "test.stridetechgo.not_null_enriched_user_user_id.fc955e4659", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect user_id\nfrom `dev`.`dbt-nstankus_enriched`.`enriched_user`\nwhere user_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-04-09T21:18:10.313387Z", "completed_at": "2024-04-09T21:18:10.323484Z"}, {"name": "execute", "started_at": "2024-04-09T21:18:10.337797Z", "completed_at": "2024-04-09T21:18:20.082581Z"}], "thread_id": "Thread-6 (worker)", "execution_time": 9.891381978988647, "adapter_response": {"_message": "OK", "query_id": "01eef6b6-ab81-1662-af63-2ff1dd6e062b"}, "message": "OK", "failures": null, "unique_id": "model.stridetechgo.enriched_trial", "compiled": true, "compiled_code": "SELECT \n    trial_type,\n    MD5(trial_type) AS trial_id,\n    current_timestamp() AS lastupdated\nFROM `dev`.`dbt-nstankus_curated`.`curated_fact_stg`\nGROUP BY \n    trial_type,\n    MD5(trial_type)", "relation_name": "`dev`.`dbt-nstankus_enriched`.`enriched_trial`"}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2024-04-09T21:18:19.124353Z", "completed_at": "2024-04-09T21:18:19.129247Z"}, {"name": "execute", "started_at": "2024-04-09T21:18:19.132231Z", "completed_at": "2024-04-09T21:18:20.382669Z"}], "thread_id": "Thread-5 (worker)", "execution_time": 1.367283821105957, "adapter_response": {"_message": "OK", "query_id": "01eef6b6-b03e-1993-9095-465b5d43eb56"}, "message": null, "failures": 0, "unique_id": "test.stridetechgo.unique_enriched_user_user_id.7903fc603b", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    user_id as unique_field,\n    count(*) as n_records\n\nfrom `dev`.`dbt-nstankus_enriched`.`enriched_user`\nwhere user_id is not null\ngroup by user_id\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2024-04-09T21:18:19.961295Z", "completed_at": "2024-04-09T21:18:19.988555Z"}, {"name": "execute", "started_at": "2024-04-09T21:18:19.990428Z", "completed_at": "2024-04-09T21:18:21.056001Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 1.3567109107971191, "adapter_response": {"_message": "OK", "query_id": "01eef6b6-b0bf-17fe-8e09-962bebcdf205"}, "message": null, "failures": 0, "unique_id": "test.stridetechgo.not_null_enriched_hour_hour_id.9212fc7e6e", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect hour_id\nfrom `dev`.`dbt-nstankus_enriched`.`enriched_hour`\nwhere hour_id is null\n\n\n", "relation_name": null}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2024-04-09T21:18:19.963352Z", "completed_at": "2024-04-09T21:18:19.982728Z"}, {"name": "execute", "started_at": "2024-04-09T21:18:19.984597Z", "completed_at": "2024-04-09T21:18:21.327919Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 1.4804730415344238, "adapter_response": {"_message": "OK", "query_id": "01eef6b6-b0c5-1517-9089-dadc818b0cea"}, "message": null, "failures": 0, "unique_id": "test.stridetechgo.unique_enriched_hour_hour_id.b2e40e661f", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    hour_id as unique_field,\n    count(*) as n_records\n\nfrom `dev`.`dbt-nstankus_enriched`.`enriched_hour`\nwhere hour_id is not null\ngroup by hour_id\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2024-04-09T21:18:20.201478Z", "completed_at": "2024-04-09T21:18:20.212487Z"}, {"name": "execute", "started_at": "2024-04-09T21:18:20.215780Z", "completed_at": "2024-04-09T21:18:21.325711Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 1.2476379871368408, "adapter_response": {"_message": "OK", "query_id": "01eef6b6-b0e3-193b-b78e-39cb61ddf220"}, "message": null, "failures": 0, "unique_id": "test.stridetechgo.not_null_enriched_trial_trial_id.8ef1d288ad", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect trial_id\nfrom `dev`.`dbt-nstankus_enriched`.`enriched_trial`\nwhere trial_id is null\n\n\n", "relation_name": null}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2024-04-09T21:18:20.206946Z", "completed_at": "2024-04-09T21:18:20.213269Z"}, {"name": "execute", "started_at": "2024-04-09T21:18:20.219140Z", "completed_at": "2024-04-09T21:18:21.371844Z"}], "thread_id": "Thread-6 (worker)", "execution_time": 1.2878870964050293, "adapter_response": {"_message": "OK", "query_id": "01eef6b6-b0e5-1209-9c72-2eb1734d6661"}, "message": null, "failures": 0, "unique_id": "test.stridetechgo.unique_enriched_trial_trial_id.42bec42e1a", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    trial_id as unique_field,\n    count(*) as n_records\n\nfrom `dev`.`dbt-nstankus_enriched`.`enriched_trial`\nwhere trial_id is not null\ngroup by trial_id\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-04-09T21:18:10.301883Z", "completed_at": "2024-04-09T21:18:10.322073Z"}, {"name": "execute", "started_at": "2024-04-09T21:18:10.326994Z", "completed_at": "2024-04-09T21:18:23.005576Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 12.816710948944092, "adapter_response": {"_message": "OK", "query_id": "01eef6b6-ab7d-1ea7-ac82-ff2b92332d91"}, "message": "OK", "failures": null, "unique_id": "model.stridetechgo.enriched_device", "compiled": true, "compiled_code": "SELECT \n    COALESCE(f.device, pt.device, s.device) AS device,\n    md5(COALESCE(f.device, pt.device, s.device)) AS device_id,\n    current_timestamp() AS lastupdated\nFROM `dev`.`dbt-nstankus_curated`.`curated_fact_stg` f\nFULL JOIN `dev`.`integrated`.`physical_therapy_evals` pt\n    ON pt.device = f.device\nFULL JOIN `dev`.`integrated`.`user_surveys` s\n    ON s.device = f.device\nWHERE COALESCE(f.device, pt.device, s.device) IS NOT NULL\nGROUP BY \n    COALESCE(f.device, pt.device, s.device),\n    md5(COALESCE(f.device, pt.device, s.device))", "relation_name": "`dev`.`dbt-nstankus_enriched`.`enriched_device`"}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2024-04-09T21:18:23.159558Z", "completed_at": "2024-04-09T21:18:23.174067Z"}, {"name": "execute", "started_at": "2024-04-09T21:18:23.180409Z", "completed_at": "2024-04-09T21:18:24.138015Z"}], "thread_id": "Thread-5 (worker)", "execution_time": 1.0913069248199463, "adapter_response": {"_message": "OK", "query_id": "01eef6b6-b2ae-15e1-88bd-b659a507afa6"}, "message": null, "failures": 0, "unique_id": "test.stridetechgo.not_null_enriched_device_device_id.3e9e77ed3d", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect device_id\nfrom `dev`.`dbt-nstankus_enriched`.`enriched_device`\nwhere device_id is null\n\n\n", "relation_name": null}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2024-04-09T21:18:23.165558Z", "completed_at": "2024-04-09T21:18:23.189014Z"}, {"name": "execute", "started_at": "2024-04-09T21:18:23.192829Z", "completed_at": "2024-04-09T21:18:24.316981Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 1.2743470668792725, "adapter_response": {"_message": "OK", "query_id": "01eef6b6-b2ad-1809-a735-c56b91eb083d"}, "message": null, "failures": 0, "unique_id": "test.stridetechgo.unique_enriched_device_device_id.923130e507", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    device_id as unique_field,\n    count(*) as n_records\n\nfrom `dev`.`dbt-nstankus_enriched`.`enriched_device`\nwhere device_id is not null\ngroup by device_id\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-04-09T21:18:24.445644Z", "completed_at": "2024-04-09T21:18:24.452209Z"}, {"name": "execute", "started_at": "2024-04-09T21:18:24.459299Z", "completed_at": "2024-04-09T21:18:29.043014Z"}], "thread_id": "Thread-6 (worker)", "execution_time": 4.712261915206909, "adapter_response": {"_message": "OK", "query_id": "01eef6b6-b3b3-1c21-8c0f-a93bbcd0aa79"}, "message": "OK", "failures": null, "unique_id": "model.stridetechgo.curated_fact_user_surveys", "compiled": true, "compiled_code": "SELECT \n    self_reported_physical_activity_per_week_hrs,\n    satisfied_with_activity,\n    fear_of_falling,\n    fall_history,\n    length_of_time_using_walker,\n    likes_using_walker,\n    received_walker_training,\n    description_of_changes_in_DLa,\n    would_purchase_stg,\n    how_much_would_you_pay,\n    would_recommend_stg,\n    stg_helped_learn_use_walker_better,\n    d.device_id,\n    u.user_id,\n    fac.facility_id,\n    current_timestamp() AS lastupdated\nFROM `dev`.`integrated`.`user_surveys` us\nleft join `dev`.`dbt-nstankus_enriched`.`enriched_device` d\n    on d.device = us.device\nleft join `dev`.`dbt-nstankus_enriched`.`enriched_user` u\n    on u.user = us.user\nleft join `dev`.`dbt-nstankus_enriched`.`enriched_facility` fac\n    on fac.facility = us.facility", "relation_name": "`dev`.`dbt-nstankus_curated`.`curated_fact_user_surveys`"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-04-09T21:18:24.440689Z", "completed_at": "2024-04-09T21:18:24.451364Z"}, {"name": "execute", "started_at": "2024-04-09T21:18:24.454409Z", "completed_at": "2024-04-09T21:18:29.047529Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 4.716092824935913, "adapter_response": {"_message": "OK", "query_id": "01eef6b6-b3b6-1c67-8864-81ba3be429b6"}, "message": "OK", "failures": null, "unique_id": "model.stridetechgo.curated_fact_physical_therapy_evals", "compiled": true, "compiled_code": "SELECT \n    NULL AS start_week,\n    NULL AS end_week,\n    start_abc_score,\n    start_tug_score_fastest_attempt,\n    start_tandem_balance_total_time,\n    start_successful_tandem_balance_positions,\n    start_functional_reach,\n    end_abc_score,\n    end_tug_score_fastest_attempt,\n    end_tandem_balance_score_total,\n    end_successful_tandem_balance_positions,\n    end_functional_reach,\n    d.device_id,\n    u.user_id,\n    fac.facility_id,\n    current_timestamp() AS lastupdated\nfrom `dev`.`integrated`.`physical_therapy_evals` pt\nleft join `dev`.`dbt-nstankus_enriched`.`enriched_device` d\n    on d.device = pt.device\nleft join `dev`.`dbt-nstankus_enriched`.`enriched_user` u\n    on u.user = pt.user\nleft join `dev`.`dbt-nstankus_enriched`.`enriched_facility` fac\n    on fac.facility = pt.facility", "relation_name": "`dev`.`dbt-nstankus_curated`.`curated_fact_physical_therapy_evals`"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-04-09T21:18:29.159057Z", "completed_at": "2024-04-09T21:18:29.164927Z"}, {"name": "execute", "started_at": "2024-04-09T21:18:29.166366Z", "completed_at": "2024-04-09T21:18:38.144153Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 9.123408794403076, "adapter_response": {"_message": "OK", "query_id": "01eef6b6-b689-11cd-bff5-0bdc7674b812"}, "message": "OK", "failures": null, "unique_id": "model.stridetechgo.enriched_fact_stg", "compiled": true, "compiled_code": "select\n    left_misuse_flag,\n    right_misuse_flag,\n    hip_misuse_flag,\n    total_misuse_flag,\n    e.activity_flag AS activity_sec,\n    left_lbf,\n    right_lbf,\n    left_adc,\n    right_adc,\n    hip_distance,\n    left_vibration_trigger,\n    right_vibration_trigger,\n    hip_vibration_trigger,\n    force_threshold,\n    hip_distance_threshold,\n    baseline_left_adc,\n    baseline_right_adc,\n    left_adc_change,\n    right_adc_change,\n    fsr_length_adjustment,\n    -- PT metrics\n    start_abc_score,\n    start_tug_score_fastest_attempt,\n    start_tandem_balance_total_time,\n    start_successful_tandem_balance_positions,\n    start_functional_reach,\n    end_abc_score,\n    end_tug_score_fastest_attempt,\n    end_tandem_balance_score_total,\n    end_successful_tandem_balance_positions,\n    end_functional_reach,\n    -- Survey metrics\n    self_reported_physical_activity_per_week_hrs,\n    satisfied_with_activity,\n    fear_of_falling,\n    fall_history,\n    length_of_time_using_walker,\n    likes_using_walker,\n    received_walker_training,\n    description_of_changes_in_DLa,\n    would_purchase_stg,\n    how_much_would_you_pay,\n    would_recommend_stg,\n    stg_helped_learn_use_walker_better,\n    u.user_id,\n    h.hour_id,\n    t.trial_id,\n    d.device_id,\n    e.extraction_time \nfrom `dev`.`dbt-nstankus_curated`.`curated_fact_stg` e\njoin `dev`.`dbt-nstankus_enriched`.`enriched_user` u\n    on u.user = e.user\njoin `dev`.`dbt-nstankus_enriched`.`enriched_hour` h\n    on h.week = e.week\n    and h.hour = date_trunc('hour', e.user_time)\njoin `dev`.`dbt-nstankus_enriched`.`enriched_trial` t\n    on t.trial_type = e.trial_type\njoin `dev`.`dbt-nstankus_enriched`.`enriched_device` d \n    on d.device = e.device\nleft join `dev`.`dbt-nstankus_curated`.`curated_fact_physical_therapy_evals` pt\n    on pt.user_id = u.user_id\n    and pt.device_id = d.device_id\nleft join `dev`.`dbt-nstankus_curated`.`curated_fact_user_surveys` us\n    on us.user_id = u.user_id\n    and us.device_id = d.device_id\n-- Flag for inactivity\nand e.activity_flag > 0", "relation_name": "`dev`.`dbt-nstankus_enriched`.`enriched_fact_stg`"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-04-09T21:18:38.288048Z", "completed_at": "2024-04-09T21:18:38.292914Z"}, {"name": "execute", "started_at": "2024-04-09T21:18:38.294566Z", "completed_at": "2024-04-09T21:18:43.622962Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 5.446432113647461, "adapter_response": {"_message": "OK", "query_id": "01eef6b6-bbe9-163c-a3fb-d181db3c5c4b"}, "message": "OK", "failures": null, "unique_id": "model.stridetechgo.enriched_fact_stg_hourly", "compiled": true, "compiled_code": "select\n    count(1) as total_captured_sec,\n    CAST(SUM(activity_sec) AS NUMERIC) AS total_activity_sec,\n    TRY_CAST(AVG(left_lbf) AS NUMERIC) AS avg_left,\n    MAX(left_lbf) AS max_left,\n    MIN(left_lbf) AS min_left,\n    TRY_CAST(AVG(right_lbf) AS NUMERIC) AS avg_right,\n    MAX(right_lbf) AS max_right,\n    MIN(right_lbf) AS min_right,\n    CAST(AVG(force_threshold) AS DECIMAL(4,2)) AS force_thresh,\n    CAST(AVG(hip_distance) AS DECIMAL(4,2)) AS avg_hip_distance,\n    MAX(hip_distance) AS max_hip_distance,\n    MIN(hip_distance) AS min_hip_distance,\n    CAST(AVG(hip_distance_threshold) AS DECIMAL(4,2)) AS hip_thresh,\n    SUM(left_misuse_flag) AS left_misuse_event,\n    SUM(right_misuse_flag) AS right_misuse_event,\n    SUM(hip_misuse_flag) AS hip_misuse_event,\n    SUM(total_misuse_flag) AS total_misuse_event,\n    -- PT metrics\n    MAX(start_abc_score) AS start_abc_score,\n    MAX(start_tug_score_fastest_attempt) AS start_tug_score_fastest_attempt,\n    MAX(start_tandem_balance_total_time) AS start_tandem_balance_total_time,\n    MAX(start_successful_tandem_balance_positions) AS start_successful_tandem_balance_positions,\n    MAX(start_functional_reach) AS start_functional_reach,\n    MAX(end_abc_score) AS end_abc_score,\n    MAX(end_tug_score_fastest_attempt) AS end_tug_score_fastest_attempt,\n    MAX(end_tandem_balance_score_total) AS end_tandem_balance_score_total,\n    MAX(end_successful_tandem_balance_positions) AS end_successful_tandem_balance_positions,\n    MAX(end_functional_reach) AS end_functional_reach,\n    -- Survey metrics\n    MAX(self_reported_physical_activity_per_week_hrs) AS self_reported_physical_activity_per_week_hrs,\n    MAX(satisfied_with_activity) AS satisfied_with_activity,\n    MAX(fear_of_falling) AS fear_of_falling,\n    MAX(fall_history) AS fall_history,\n    MAX(length_of_time_using_walker) AS length_of_time_using_walker,\n    MAX(likes_using_walker) AS likes_using_walker,\n    MAX(received_walker_training) AS received_walker_training,\n    MAX(description_of_changes_in_DLa) AS description_of_changes_in_DLa,\n    MAX(would_purchase_stg) AS would_purchase_stg,\n    MAX(how_much_would_you_pay) AS how_much_would_you_pay,\n    MAX(would_recommend_stg) AS would_recommend_stg,\n    MAX(stg_helped_learn_use_walker_better) AS stg_helped_learn_use_walker_better,\n    user_id,\n    device_id,\n    hour_id,\n    trial_id,\n    -- Adding adc values\n    TRY_CAST(AVG(left_adc) AS NUMERIC) AS avg_left_adc,\n    MAX(left_adc) AS max_left_adc,\n    MIN(left_adc) AS min_left_adc,\n    TRY_CAST(AVG(right_adc) AS NUMERIC) AS avg_right_adc,\n    MAX(right_adc) AS max_right_adc,\n    MIN(right_adc) AS min_right_adc,\n    MAX(extraction_time) AS lastupdated\nfrom `dev`.`dbt-nstankus_enriched`.`enriched_fact_stg`\ngroup by hour_id, trial_id, user_id, device_id", "relation_name": "`dev`.`dbt-nstankus_enriched`.`enriched_fact_stg_hourly`"}], "elapsed_time": 72.34110903739929, "args": {"write_json": true, "defer": false, "print": true, "include_saved_query": false, "enable_legacy_logger": false, "log_path": "/Users/stankusnt/stg_pipeline/stg_dbt_pipeline/target/dbt_analytics-2ae6a36-e5aaae2", "version_check": true, "log_file_max_bytes": 10485760, "introspect": true, "favor_state": false, "invocation_command": "dbt build --select fqn:*", "show": false, "static_parser": true, "project_dir": "/Users/stankusnt/stg_pipeline/stg_dbt_pipeline", "vars": {}, "exclude": [], "use_colors_file": true, "use_colors": true, "which": "build", "profiles_dir": "/Users/stankusnt/stg_pipeline/stg_dbt_pipeline", "quiet": false, "printer_width": 80, "partial_parse_file_diff": true, "send_anonymous_usage_stats": false, "warn_error_options": {"include": [], "exclude": []}, "log_level_file": "debug", "strict_mode": false, "log_format_file": "json", "indirect_selection": "eager", "partial_parse": true, "select": ["fqn:*"], "resource_types": [], "populate_cache": true, "macro_debugging": false, "show_resource_report": false, "target_path": "target/dbt_analytics-2ae6a36-e5aaae2", "log_level": "info", "cache_selected_only": false, "log_format": "json"}}